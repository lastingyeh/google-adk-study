# æ·±åº¦ç ”ç©¶ä»£ç† (Deep Research Agent) ç¯„ä¾‹

æœ¬ç¯„ä¾‹å±•ç¤ºå¦‚ä½•é€é Interactions API ä½¿ç”¨ Google çš„æ·±åº¦ç ”ç©¶ä»£ç† (Deep Research Agent) é€²è¡Œè‡ªä¸»ã€å¤šæ­¥é©Ÿçš„ç ”ç©¶ä»»å‹™ã€‚

## åŠŸèƒ½ç‰¹è‰²

- **èƒŒæ™¯åŸ·è¡Œ**ï¼šé©ç”¨æ–¼é•·æ™‚é–“é‹è¡Œçš„ç ”ç©¶ä»»å‹™
- **ä¸²æµå‚³è¼¸**ï¼šæä¾›é€²åº¦æ›´æ–° (æ€è€ƒæ‘˜è¦)
- **è‡ªå®šç¾©æ ¼å¼**ï¼šå¯å¼•å°çš„è¼¸å‡ºæ ¼å¼
- **å¾ŒçºŒå°è©±**ï¼šç ”ç©¶å®Œæˆå¾Œå¯é€²è¡Œè¿½å•
- **éŒ¯èª¤è™•ç†**ï¼šåŒ…å«é‡è©¦æ¨¡å¼

## å…ˆæ±ºæ¢ä»¶

```bash
# å®‰è£ä¾è³´
make setup

# è¨­å®šæ‚¨çš„ API é‡‘é‘°
export GOOGLE_API_KEY="your-api-key-here"
```

## å¿«é€Ÿé–‹å§‹

```bash
# åŸ·è¡Œæ¸¬è©¦ä»¥é©—è­‰è¨­å®š
make test

# åŸ·è¡Œç ”ç©¶æ¼”ç¤º
make demo

# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æŒ‡ä»¤
make help
```

## æ ¸å¿ƒæ¦‚å¿µ

### èƒŒæ™¯åŸ·è¡Œ

æ·±åº¦ç ”ç©¶éœ€è¦è¨­å®š `background=True`ï¼Œå› ç‚ºç ”ç©¶ä»»å‹™å¯èƒ½éœ€è¦æ•¸åˆ†é˜æ‰èƒ½å®Œæˆï¼š

```python
from google import genai

client = genai.Client()

# é–‹å§‹ç ”ç©¶ (ç«‹å³è¿”å›)
interaction = client.interactions.create(
    input="Research the future of quantum computing.",
    agent="deep-research-pro-preview-12-2025",
    background=True
)

# è¼ªè©¢å®Œæˆç‹€æ…‹
while interaction.status != "completed":
    interaction = client.interactions.get(interaction.id)
    time.sleep(10)

print(interaction.outputs[-1].text)
```

### å¸¶æœ‰æ€è€ƒéç¨‹çš„ä¸²æµå‚³è¼¸

ç²å–å³æ™‚é€²åº¦æ›´æ–°ï¼š

```python
stream = client.interactions.create(
    input="Research AI trends in 2025.",
    agent="deep-research-pro-preview-12-2025",
    background=True,
    stream=True,
    agent_config={
        "type": "deep-research",
        "thinking_summaries": "auto"
    }
)

for chunk in stream:
    if chunk.event_type == "content.delta":
        if chunk.delta.type == "thought_summary":
            print(f"ğŸ’­ {chunk.delta.content.text}")
        elif chunk.delta.type == "text":
            print(chunk.delta.text, end="")
```

### è‡ªå®šç¾©æ ¼å¼

é€éæç¤ºè© (Prompt) å¼•å°è¼¸å‡ºæ ¼å¼ï¼š

```python
prompt = """
ç ”ç©¶é›»å‹•è»Šçš„æ™®åŠç‡ã€‚

å°‡è¼¸å‡ºæ ¼å¼åŒ–ç‚ºï¼š
1. åŸ·è¡Œæ‘˜è¦ (3å¥è©±)
2. é—œéµçµ±è¨ˆæ•¸æ“š (è¡¨æ ¼æ ¼å¼)
3. å€åŸŸåˆ†æ
4. æœªä¾†å±•æœ›
"""

interaction = client.interactions.create(
    input=prompt,
    agent="deep-research-pro-preview-12-2025",
    background=True
)
```

## æˆæœ¬åˆ†æ ğŸ’°

Gemini æ·±åº¦ç ”ç©¶ä»£ç†ä½¿ç”¨ **Gemini 3 Pro Preview** æ¨¡å‹ï¼Œæ”¶è²»åŸºæ–¼ Token æ¶ˆè€—é‡å’Œå·¥å…·ä½¿ç”¨é‡ã€‚

### æ¨¡å‹å®šåƒ¹ (æ‰¹æ¬¡æ¨¡å¼)

| é …ç›®                            | æˆæœ¬                   | å‚™è¨»                        |
| ------------------------------- | ---------------------- | --------------------------- |
| **è¼¸å…¥ Token**                  | æ¯ 100 è¬ Token $2.00  | æ–‡å­—ã€åœ–ç‰‡ã€å½±ç‰‡è¼¸å…¥        |
| **è¼¸å‡º Token**                  | æ¯ 100 è¬ Token $12.00 | æ–‡å­—å›æ‡‰å’Œæ¨ç†              |
| **ä¸Šä¸‹æ–‡å¿«å–**                  | æ¯ 100 è¬ Token $0.20  | é©ç”¨æ–¼ Prompt â‰¤ 20 è¬ Token |
| **Google æœå°‹æ¥åœ° (Grounding)** | æ¯ 1,000 æ¬¡æŸ¥è©¢ $35\*  | æ¯æœˆ 5,000 æ¬¡å…è²»é¡åº¦å¾Œ     |

\*å®šåƒ¹æ–¼ 2026 å¹´ 1 æœˆ 5 æ—¥é–‹å§‹ç”Ÿæ•ˆã€‚ç›®å‰å…è²»ä½†å—é™æ–¼å¯ç”¨å±¤ç´šã€‚

### å…¸å‹ç ”ç©¶æˆæœ¬ä¼°ç®—

åŸºæ–¼å…¸å‹çš„æ·±åº¦ç ”ç©¶æŸ¥è©¢ (20 åˆ†é˜çš„ç ”ç©¶å·¥ä½œéšæ®µ)ï¼š

| æŒ‡æ¨™                       | æ•¸å€¼                 | è¨ˆç®—æ–¹å¼              |
| -------------------------- | -------------------- | --------------------- |
| **æ¯æ¬¡æŸ¥è©¢å¹³å‡è¼¸å…¥ Token** | ~2,000 Token         | åˆå§‹ç ”ç©¶æç¤º + ä¸Šä¸‹æ–‡ |
| **å¹³å‡æœå°‹æŸ¥è©¢æ¬¡æ•¸**       | 5-8 æ¬¡æŸ¥è©¢           | è¦åŠƒ + è¿­ä»£æœå°‹       |
| **é ä¼°è¼¸å‡º Token**         | ~8,000-12,000 Token  | ç¶œåˆç ”ç©¶å ±å‘Š          |
| **å·¥ä½œéšæ®µç¸½ Token**       | ~50,000-80,000 Token | è¼¸å…¥ + è™•ç† + è¼¸å‡º    |
| **æ¯æ¬¡ç ”ç©¶é ä¼°æˆæœ¬**       | **$0.70-$1.20**      | ä¾æ¨™æº–æ‰¹æ¬¡è²»ç‡è¨ˆç®—    |

### æˆæœ¬å„ªåŒ–æŠ€å·§

1. **ä½¿ç”¨æ‰¹æ¬¡æ¨¡å¼**ï¼šæˆæœ¬é™ä½ 50% (ä¸é©ç”¨æ–¼å…è²»å±¤ç´š)
2. **å…·é«”æ˜ç¢º**ï¼šè©³ç´°çš„æŸ¥è©¢å¯æ¸›å°‘è¿­ä»£æœå°‹æ¬¡æ•¸
3. **ç›£æ§ç”¨é‡**ï¼šæª¢æŸ¥å›æ‡‰ä¸­çš„ Token è¨ˆæ•¸
4. **å…è²»å±¤ç´šé™åˆ¶**ï¼š
   - æ¯æœˆ 5,000 æ¬¡å…è²»æœå°‹æŸ¥è©¢ (Grounding)
   - å……è£•çš„å…è²» Token é¡åº¦ä¾›æ¸¬è©¦ä½¿ç”¨

### ç”Ÿç”¢ç’°å¢ƒæˆæœ¬æƒ…å¢ƒ

| æƒ…å¢ƒ                           | æ¯æœˆé ä¼°  | è©³ç´°è³‡è¨Š       |
| ------------------------------ | --------- | -------------- |
| **è¼•é‡ä½¿ç”¨** (æ¯æœˆ 10 æ¬¡æŸ¥è©¢)  | ~$8-12    | é–‹ç™¼/æ¸¬è©¦      |
| **æ¨™æº–ä½¿ç”¨** (æ¯æœˆ 100 æ¬¡æŸ¥è©¢) | ~$70-120  | å¸¸è¦ç ”ç©¶ä»»å‹™   |
| **é‡åº¦ä½¿ç”¨** (æ¯æœˆ 500 æ¬¡æŸ¥è©¢) | ~$350-600 | ä¼æ¥­ç´šç ”ç©¶æµç¨‹ |

### åƒè€ƒè³‡æ–™

- [Gemini API å®šåƒ¹](https://ai.google.dev/gemini-api/docs/pricing) - æœ€æ–°å®˜æ–¹å®šåƒ¹
- [Vertex AI å®šåƒ¹](https://cloud.google.com/vertex-ai/generative-ai/pricing) - ä¼æ¥­é¸é …
- å®šåƒ¹æˆªè‡³ 2025 å¹´ 12 æœˆæœ‰æ•ˆ

## ç–‘é›£æ’è§£

### éŒ¯èª¤ 429ï¼šé…é¡å·²æ»¿ (Quota Exceeded)

**ç—‡ç‹€**ï¼š`Error code: 429 - You do not have enough quota to make this request`

**åŸå› **ï¼š

- å…è²»å±¤ç´šé€Ÿç‡é™åˆ¶ (é€šå¸¸ç‚ºæ¯å¤© 100-200 æ¬¡è«‹æ±‚)
- è¶…å‡ºæ¯æœˆé…é¡åˆ†é…
- éå¤šä½µç™¼è«‹æ±‚

**è§£æ±ºæ–¹æ¡ˆ**ï¼š

#### 1. **ç­‰å¾…é…é¡é‡ç½®** (ç«‹å³)

```bash
# å…è²»å±¤ç´šé…é¡æ¯ 24 å°æ™‚é‡ç½®ä¸€æ¬¡
# æ˜å¤©å†è©¦
make demo  # ä½¿ç”¨æ¨¡æ“¬æ¨¡å¼ (ç„¡éœ€é…é¡)
```

#### 2. **åˆ‡æ›è‡³å…è²»æ¨¡æ“¬æ¨¡å¼** (ç«‹å³)

```bash
make demo  # å±•ç¤ºç„¡éœ€ API å‘¼å«çš„æ·±åº¦ç ”ç©¶
```

#### 3. **å‡ç´šè‡³ä»˜è²»å±¤ç´š** (å»ºè­°ç”¨æ–¼æ¸¬è©¦)

```mermaid
graph TD
    A[å‰å¾€ Google AI Studio] --> B[é»æ“Š Get API Key]
    B --> C[åœ¨æ–°çš„ Google Cloud å°ˆæ¡ˆä¸­å»ºç«‹ API Key]
    C --> D[åœ¨ Google Cloud Console å•Ÿç”¨è¨ˆè²»]
    D --> E[è¨­å®šç’°å¢ƒè®Šæ•¸ GOOGLE_API_KEY]
    E --> F[é‡è©¦: make research]
```

**å„ªé»**ï¼š

- æ›´é«˜çš„é€Ÿç‡é™åˆ¶ (æ¯å¤©æ•¸åƒæ¬¡è«‹æ±‚)
- ä¾ä½¿ç”¨é‡ä»˜è²»
- æ›´å¥½çš„é…é¡ç®¡ç†

#### 3b. **ä½¿ç”¨ Vertex AI** (é©ç”¨æ–¼å·²æœ‰å°ˆæ¡ˆçš„ GCP ä½¿ç”¨è€…)

å¦‚æœæ‚¨å·²ç¶“æœ‰å•Ÿç”¨ Vertex AI çš„ Google Cloud å°ˆæ¡ˆï¼š

```mermaid
graph TD
    A[GCP å°ˆæ¡ˆèªè­‰<br>gcloud auth login] --> B[è¨­å®š Vertex AI ç«¯é»<br>VERTEX_AI_PROJECT_ID]
    B --> C[æ›´æ–° research_agent/.env<br>USE_VERTEX_AI=true]
    C --> D[ä¿®æ”¹ agent.py ä½¿ç”¨ Vertex AI ç”¨æˆ¶ç«¯]
    D --> E[é‡è©¦: make research]
```

**å„ªé»**ï¼š

- ä½¿ç”¨ç¾æœ‰ GCP å°ˆæ¡ˆé…é¡
- ä¼æ¥­ç´šé…é¡ (é€šå¸¸è¼ƒé«˜)
- Cloud Logging ä¸­çš„ç¨½æ ¸è»Œè·¡
- èˆ‡å…¶ä»– GCP æœå‹™æ•´åˆ
- æ½›åœ¨çš„ç”¨é‡æŠ˜æ‰£

**å®šåƒ¹**ï¼š

- èˆ‡ Google AI Studio ç›¸åŒ (è¼¸å…¥ $2.00/1Mï¼Œè¼¸å‡º $12.00/1M Token)
- å¸³å–®è¨ˆå…¥æ‚¨çš„ GCP å°ˆæ¡ˆ
- å…è²»å±¤ç´šé…é¡å¯èƒ½ä¾å°ˆæ¡ˆè¨­å®šè€Œå®š

#### 4. **ç”³è«‹æ›´é«˜é…é¡** (ç”¨æ–¼ç”Ÿç”¢ç’°å¢ƒ)

å¦‚æœæ‚¨æœ‰ç¾æœ‰çš„ Google Cloud å°ˆæ¡ˆï¼š

```mermaid
graph TD
    A[å‰å¾€ Google Cloud Console] --> B[é¸æ“‡æ‚¨çš„å°ˆæ¡ˆ]
    B --> C[å°èˆªè‡³: APIs & Services -> Quotas]
    C --> D[æ‰¾åˆ° Generative AI API]
    D --> E[é¸æ“‡ Daily quota ä¸¦ç”³è«‹å¢åŠ ]
    E --> F[Google å¯©æ ¸ä¸¦æ‰¹å‡†<br>é€šå¸¸ 1-3 å¤©]
```

#### 5. **è¯ç¹« Google Cloud éŠ·å”®åœ˜éšŠ** (ç”¨æ–¼ä¼æ¥­)

é‡å°å¤§è¦æ¨¡ç”Ÿç”¢éƒ¨ç½²ï¼š

- [Google Cloud è¯ç¹«é é¢](https://cloud.google.com/contact)
- è¨è«–ï¼šå°ˆç”¨é…é¡ã€SLAã€æ”¯æ´
- ç²å–ï¼šç”¨é‡æŠ˜æ‰£ã€è‡ªå®šç¾©é€Ÿç‡é™åˆ¶

### å…¶ä»–å¸¸è¦‹å•é¡Œ

| éŒ¯èª¤                                               | åŸå›          | è§£æ±ºæ–¹æ¡ˆ                                |
| -------------------------------------------------- | ------------ | --------------------------------------- |
| `ImportError: cannot import name 'ResearchStatus'` | ç¼ºå°‘ä¾è³´     | åŸ·è¡Œï¼š`make setup`                      |
| `GOOGLE_API_KEY not set`                           | ç¼ºå°‘ç’°å¢ƒè®Šæ•¸ | è¨­å®šé‡‘é‘°ï¼š`export GOOGLE_API_KEY='...'` |
| ç ”ç©¶è€—æ™‚ >60 åˆ†é˜                                  | è¤‡é›œæŸ¥è©¢éå¤§ | ç°¡åŒ–æŸ¥è©¢ï¼Œæ‹†åˆ†ç‚ºè¼ƒå°çš„éƒ¨åˆ†              |
| `connection timeout`                               | ç¶²è·¯å•é¡Œ     | æª¢æŸ¥ç¶²è·¯ï¼Œä½¿ç”¨ `--max-wait 300` é‡è©¦    |

## ä½¿ç”¨æ¡ˆä¾‹

| ä½¿ç”¨æ¡ˆä¾‹ | æŸ¥è©¢ç¯„ä¾‹                          |
| -------- | --------------------------------- |
| å¸‚å ´ç ”ç©¶ | "åˆ†æ AI ç¨‹å¼ç¢¼åŠ©ç†çš„ç«¶çˆ­æ ¼å±€"    |
| ç›¡è·èª¿æŸ¥ | "ç ”ç©¶ X å…¬å¸çš„è²¡å‹™è¡¨ç¾å’Œå¸‚å ´åœ°ä½" |
| æ–‡ç»å›é¡§ | "èª¿æŸ¥ Transformer æ¶æ§‹çš„æœ€æ–°é€²å±•" |
| ç«¶çˆ­åˆ†æ | "æ¯”è¼ƒé›²ç«¯ä¾›æ‡‰å•†çš„å®šåƒ¹å’ŒåŠŸèƒ½"      |

## å°ˆæ¡ˆçµæ§‹

```
deep-research-agent/
â”œâ”€â”€ Makefile                    # å»ºç½®å’ŒåŸ·è¡ŒæŒ‡ä»¤
â”œâ”€â”€ README.md                   # æœ¬æª”æ¡ˆ
â”œâ”€â”€ pyproject.toml             # å°ˆæ¡ˆè¨­å®š
â”œâ”€â”€ requirements.txt           # ä¾è³´é …ç›®
â”œâ”€â”€ research_agent/            # ä¸»è¦ä»£ç†æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent.py               # æ·±åº¦ç ”ç©¶å¯¦ä½œ
â”‚   â”œâ”€â”€ streaming.py           # ä¸²æµå·¥å…·
â”‚   â””â”€â”€ .env.example           # ç’°å¢ƒç¯„æœ¬
â””â”€â”€ tests/                     # æ¸¬è©¦å¥—ä»¶
    â””â”€â”€ test_research.py       # ç ”ç©¶ä»£ç†æ¸¬è©¦
```

## é™åˆ¶

- æœ€å¤§ç ”ç©¶æ™‚é–“ï¼š60 åˆ†é˜ (å¤§å¤šæ•¸åœ¨ ~20 åˆ†é˜å…§å®Œæˆ)
- ç„¡è‡ªå®šç¾©å‡½å¼å‘¼å«å·¥å…· (Function Calling)
- ä¸æ”¯æ´éŸ³è¨Šè¼¸å…¥
- å°šæœªæ”¯æ´çµæ§‹åŒ–è¼¸å‡º

## äº†è§£æ›´å¤š

- [æ·±åº¦ç ”ç©¶æ–‡ä»¶](https://ai.google.dev/gemini-api/docs/deep-research)
- [éƒ¨è½æ ¼æ–‡ç« ï¼šç²¾é€š Interactions API](../../../notes/google-adk-training-hub/blog/2025-12-12-interactions-api-deep-research.md)
- [Google AI Studio](https://aistudio.google.com/apikey)
- [Vertex AI æ–‡ä»¶](https://cloud.google.com/vertex-ai/docs)
- [Vertex AI ç”Ÿæˆå¼æ¨¡å‹](https://cloud.google.com/vertex-ai/docs/generative-ai/learn/models)
- [Google Cloud SDK](https://cloud.google.com/sdk/docs)

## é‡é»æ‘˜è¦ (éç¨‹å¼ç¢¼)

- **æ ¸å¿ƒæ¦‚å¿µ**ï¼š

  - å±•ç¤ºå¦‚ä½•ä½¿ç”¨ Google çš„ Deep Research Agent å’Œ Interactions API ä¾†åŸ·è¡Œé•·æ™‚é–“é‹è¡Œçš„è‡ªä¸»ç ”ç©¶ä»»å‹™ã€‚
  - æ”¯æ´å¾èƒŒæ™¯åŸ·è¡Œåˆ°å³æ™‚ä¸²æµæ€è€ƒéç¨‹ (Thought process) çš„å¤šç¨®äº’å‹•æ¨¡å¼ã€‚

- **é—œéµæŠ€è¡“**ï¼š

  - **Interactions API**ï¼šç”¨æ–¼ç®¡ç†èˆ‡ AI ä»£ç†çš„äº’å‹•ã€‚
  - **èƒŒæ™¯åŸ·è¡Œ (Background Execution)**ï¼šè™•ç†éœ€è¦æ•¸åˆ†é˜çš„ç ”ç©¶ä»»å‹™ï¼Œä¸¦é€éè¼ªè©¢æª¢æŸ¥ç‹€æ…‹ã€‚
  - **ä¸²æµæ€è€ƒæ‘˜è¦ (Streaming Thought Summaries)**ï¼šå³æ™‚é¡¯ç¤º AI çš„æ€è€ƒèˆ‡è¦åŠƒéç¨‹ã€‚
  - **Gemini 3 Pro Preview**ï¼šåº•å±¤ä½¿ç”¨çš„æ¨¡å‹ã€‚

- **é‡è¦çµè«–**ï¼š

  - æ·±åº¦ç ”ç©¶æˆæœ¬è¼ƒé«˜ï¼Œå»ºè­°ä½¿ç”¨æ‰¹æ¬¡æ¨¡å¼ (Batch Mode) ç¯€çœ 50% æˆæœ¬ã€‚
  - é‡åˆ° 429 é…é¡éŒ¯èª¤æ™‚ï¼Œå¯åˆ‡æ›è‡³ Vertex AI æˆ–ä»˜è²»å±¤ç´šä»¥ç²å¾—æ›´é«˜é…é¡ã€‚
  - ç›®å‰æ¯æ¬¡ç ”ç©¶æˆæœ¬ç´„ç‚º $0.70 - $1.20ã€‚

- **è¡Œå‹•é …ç›®**ï¼š
  - åŸ·è¡Œ `make setup` å®‰è£ç’°å¢ƒã€‚
  - è¨­ç½® `GOOGLE_API_KEY`ã€‚
  - é€é `make demo` å…ˆè¡Œé«”é©—æ¨¡æ“¬æ¨¡å¼ï¼Œç¢ºèªç„¡èª¤å¾Œå†åŸ·è¡Œ `make research` é€²è¡Œå¯¦éš›èª¿ç”¨ã€‚
