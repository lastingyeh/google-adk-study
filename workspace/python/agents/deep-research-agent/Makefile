# Deep Research Agent Makefile
# æ­¤ Makefile ç”¨æ–¼ç®¡ç†å°ˆæ¡ˆçš„å»ºç½®ã€æ¸¬è©¦å’ŒåŸ·è¡Œä»»å‹™

.PHONY: help setup clean test demo research

help:
	@echo "æ·±åº¦ç ”ç©¶ä»£ç† (Deep Research Agent) - å¯ç”¨æŒ‡ä»¤"
	@echo "========================================="
	@echo ""
	@echo "make setup       å®‰è£ä¾è³´ä¸¦æº–å‚™ç’°å¢ƒ"
	@echo "make test        åŸ·è¡Œå–®å…ƒæ¸¬è©¦"
	@echo "make demo        åŸ·è¡Œå¿«é€Ÿæ¼”ç¤º (æ¨¡æ“¬æ¨¡å¼)"
	@echo "make research    åŸ·è¡Œå¯¦éš›ç ”ç©¶ä»»å‹™ (éœ€è¦ API é‡‘é‘°)"
	@echo "make clean       ç§»é™¤å¿«å–æª”æ¡ˆå’Œç”¢ç‰©"
	@echo ""

setup:
	# å®‰è£éœ€æ±‚å¥—ä»¶
	pip install -r requirements.txt
	# ä»¥å¯ç·¨è¼¯æ¨¡å¼å®‰è£ç•¶å‰å°ˆæ¡ˆ
	pip install -e .
	# è¤‡è£½ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹æª” (å¦‚æœä¸å­˜å‰‡å¿½ç•¥éŒ¯èª¤)
	cp research_agent/.env.example research_agent/.env 2>/dev/null || true
	@echo ""
	@echo "âœ… è¨­å®šå®Œæˆï¼"
	@echo ""
	@echo "å¾ŒçºŒæ­¥é©Ÿï¼š"
	@echo "1. å°‡æ‚¨çš„ GOOGLE_API_KEY æ–°å¢è‡³ research_agent/.env"
	@echo "   æˆ–è¨­å®šï¼šexport GOOGLE_API_KEY='your-key-here'"
	@echo "2. åŸ·è¡Œ 'make test' ä»¥é©—è­‰å¯¦ä½œ"
	@echo "3. åŸ·è¡Œ 'make demo' æŸ¥çœ‹æ¨¡æ“¬æ¼”ç¤º"
	@echo "4. åŸ·è¡Œ 'make research' é€²è¡Œå¯¦éš›ç ”ç©¶ (æœƒæ¶ˆè€— Tokenï¼)"
	@echo ""

test:
	@echo ""
	@echo "ğŸ§ª æ­£åœ¨åŸ·è¡Œæ·±åº¦ç ”ç©¶ä»£ç†æ¸¬è©¦..."
	@echo ""
	# åŸ·è¡Œ pytestï¼Œé¡¯ç¤ºè©³ç´°è³‡è¨Šèˆ‡ç°¡çŸ­çš„å›æº¯
	@pytest tests/ -v --tb=short
	@echo ""
	@echo "âœ… æ¸¬è©¦é©—è­‰é …ç›®ï¼š"
	@echo "   â€¢ ä»£ç†è¨­å®š (Agent configuration)"
	@echo "   â€¢ ç ”ç©¶ä»»å‹™å»ºç«‹ (Research task creation)"
	@echo "   â€¢ ä¸²æµå·¥å…· (Streaming utilities)"
	@echo "   â€¢ éŒ¯èª¤è™•ç† (Error handling)"
	@echo ""

demo:
	@echo ""
	@echo "ğŸ”¬ æ·±åº¦ç ”ç©¶ä»£ç†æ¼”ç¤º (æ¨¡æ“¬æ¨¡å¼)"
	@echo "========================================"
	@echo ""
	@echo "é€™å±•ç¤ºäº†ç„¡éœ€ API å‘¼å«çš„æ·±åº¦ç ”ç©¶çµæ§‹ã€‚"
	@echo "ä½¿ç”¨ 'make research' é€²è¡Œå¯¦éš›ç ”ç©¶ã€‚"
	@echo ""
	# åŸ·è¡Œæ¼”ç¤ºæ¨¡çµ„ï¼Œä½¿ç”¨ --mock åƒæ•¸
	python -m research_agent.demo --mock
	@echo ""

research:
	@echo ""
	@echo "ğŸ”¬ æ­£åœ¨åŸ·è¡Œæ·±åº¦ç ”ç©¶ä»»å‹™"
	@echo "=============================="
	@echo ""
	@echo "âš ï¸  é€™å°‡é€²è¡Œå¯¦éš›çš„ API å‘¼å«ä¸¦æ¶ˆè€— Tokenï¼"
	@echo ""
	# åŸ·è¡Œæ¼”ç¤ºæ¨¡çµ„ (å¯¦éš›æ¨¡å¼)
	python -m research_agent.demo
	@echo ""

clean:
	# æ¸…ç† __pycache__ ç›®éŒ„
	find . -type d -name __pycache__ -exec rm -rf {} + 2>/dev/null || true
	# æ¸…ç† .pytest_cache ç›®éŒ„
	find . -type d -name .pytest_cache -exec rm -rf {} + 2>/dev/null || true
	# æ¸…ç† .pyc æª”æ¡ˆ
	find . -type f -name "*.pyc" -delete
	# æ¸…ç†å»ºç½®ç”¢ç‰©
	rm -rf .coverage htmlcov build dist *.egg-info
	@echo "âœ… å·²æ¸…ç†å¿«å–æª”æ¡ˆ"
