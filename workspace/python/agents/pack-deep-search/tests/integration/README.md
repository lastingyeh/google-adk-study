# 詳細測試案例說明

## 簡介

此文件提供 `workspace/python/agents/pack-deep-search/tests/integration` 目錄下的測試案例說明，涵蓋代理功能與伺服器端點的整合測試。

## 代理功能整合測試 (`tests/integration/test_agent.py`)

此部分涵蓋代理串流功能的整合測試，驗證代理是否能正常處理請求並返回串流內容。

| 群組 | 測試案例編號 | 描述 | 前置條件 | 測試步驟 | 測試數據 | 預期結果 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **代理串流** | **TC-INT-AGENT-001** | 驗證代理串流輸出功能 | 代理服務已初始化 | 1. 建立 InMemorySessionService<br>2. 建立測試會話<br>3. 執行 Runner 發送訊息<br>4. 收集串流事件 | 訊息內容: "Why is the sky blue?" | 1. 收到至少一個事件<br>2. 至少有一個事件包含非空文字內容 |

## 伺服器端對端測試 (`tests/integration/test_server_e2e.py`)

此部分涵蓋伺服器端點的端對端測試，包括聊天串流、錯誤處理與回饋收集。

| 群組 | 測試案例編號 | 描述 | 前置條件 | 測試步驟 | 測試數據 | 預期結果 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **聊天服務** | **TC-INT-SERVER-001** | 測試聊天串流端點 | FastAPI 伺服器已啟動 | 1. 建立使用者會話<br>2. 發送 POST 請求至 /run_sse<br>3. 解析 SSE 事件流 | 訊息: "Hi!" | 1. 會話建立成功<br>2. 收到有效的 SSE 事件<br>3. 事件中包含文字內容 |
| **錯誤處理** | **TC-INT-SERVER-002** | 測試無效輸入的錯誤處理 | FastAPI 伺服器已啟動 | 1. 發送包含無效類型訊息的 POST 請求至 /run_sse | 無效類型訊息 | 伺服器返回 422 狀態碼 (Unprocessable Entity) |
| **回饋收集** | **TC-INT-SERVER-003** | 測試回饋收集端點 | FastAPI 伺服器已啟動 | 1. 發送回饋數據至 /feedback | 評分: 4, 內容: "Great response!" | 伺服器返回 200 狀態碼 |

---

### **欄位說明**

*   **群組**: 測試案例所屬的功能子群組或類別。
*   **測試案例編號**: 唯一的測試案例識別碼。
*   **描述**: 對此測試案例目標的簡潔說明。
*   **前置條件**: 執行測試前系統或環境必須處於的狀態。
*   **測試步驟**: 執行測試所需遵循的具體步驟。
*   **測試數據**: 在測試步驟中使用的具體輸入數據。
*   **預期結果**: 在成功執行測試步驟後，系統應顯示的確切結果或狀態。
