### é‡é»æ‘˜è¦
- **æ ¸å¿ƒæ¦‚å¿µ**ï¼šæœ¬æ•™å­¸ç¤ºç¯„å¦‚ä½•ä½¿ç”¨ Google ADK å®˜æ–¹çš„ `RemoteA2aAgent` é¡åˆ¥ä¾†å¯¦ç¾çœŸå¯¦çš„ä»£ç†ï¼ˆAgentï¼‰å°ä»£ç†ï¼ˆA2Aï¼‰é€šè¨Šã€‚å”èª¿å™¨ï¼ˆOrchestratorï¼‰æœƒå”èª¿å¤šå€‹ä½œç‚ºç¨ç«‹ ADK A2A ä¼ºæœå™¨é‹è¡Œçš„é ç«¯ç‰¹åŒ–ä»£ç†ï¼Œä»¥å»ºæ§‹åˆ†æ•£å¼ AI ç³»çµ±ã€‚
- **é—œéµæŠ€è¡“**ï¼š
    - ä½¿ç”¨å®˜æ–¹ `to_a2a()` å‡½å¼è¨­å®š A2A ä¼ºæœå™¨ã€‚
    - ä½¿ç”¨ `RemoteA2aAgent` èˆ‡é ç«¯ä»£ç†é€²è¡Œé€šè¨Šã€‚
    - é€é `.well-known/agent-card.json` è‡ªå‹•é€²è¡Œä»£ç†æ¢ç´¢ã€‚
    - å°‡å¤šå€‹ä»£ç†ä½œç‚ºç¨ç«‹çš„ `uvicorn` æœå‹™é‹è¡Œã€‚
    - ä½¿ç”¨å®˜æ–¹ ADK æ¨¡å¼ä¾†å”èª¿åˆ†æ•£å¼ä»£ç†å·¥ä½œæµç¨‹ã€‚
- **é‡è¦çµè«–**ï¼šé€éæœ¬æ•™å­¸ï¼Œæ‚¨å°‡å­¸æœƒå¦‚ä½•ä½¿ç”¨å®˜æ–¹ ADK A2A é€šè¨Šä¾†å»ºæ§‹åˆ†æ•£å¼å¤šä»£ç†ç³»çµ±ã€‚
- **è¡Œå‹•é …ç›®**ï¼š
    1. è¨­å®šç’°å¢ƒï¼šå®‰è£æ‰€æœ‰ä¾è³´å¥—ä»¶ä¸¦è¨­å®šæ‚¨çš„ Google API é‡‘é‘°ã€‚
    2. å•Ÿå‹•é ç«¯ A2A ä»£ç†ï¼šåœ¨ä¸€å€‹çµ‚ç«¯æ©Ÿä¸­å•Ÿå‹•æ‰€æœ‰é ç«¯ A2A ä»£ç†ã€‚
    3. å•Ÿå‹•å”èª¿å™¨ï¼šåœ¨å¦ä¸€å€‹çµ‚ç«¯æ©Ÿä¸­å•Ÿå‹• ADK é–‹ç™¼ä¼ºæœå™¨ã€‚
    4. å˜—è©¦ç¯„ä¾‹æŸ¥è©¢ã€‚

---

# æ•™å­¸ 17ï¼šä»£ç†å°ä»£ç†ï¼ˆAgent-to-Agentï¼‰é€šè¨Š - å®˜æ–¹ ADK å¯¦ä½œ

æœ¬æ•™å­¸ç¤ºç¯„å¦‚ä½•ä½¿ç”¨ Google ADK å®˜æ–¹çš„ `RemoteA2aAgent` é¡åˆ¥ä¾†å¯¦ç¾**çœŸå¯¦çš„ä»£ç†å°ä»£ç†ï¼ˆA2Aï¼‰é€šè¨Š**ã€‚å”èª¿å™¨æœƒå”èª¿å¤šå€‹ä½œç‚ºç¨ç«‹ ADK A2A ä¼ºæœå™¨é‹è¡Œçš„é ç«¯ç‰¹åŒ–ä»£ç†ï¼Œä»¥å»ºæ§‹åˆ†æ•£å¼ AI ç³»çµ±ã€‚

## ç¸½è¦½

**æ‚¨å°‡å­¸åˆ°ä»€éº¼ï¼š**
- ä½¿ç”¨å®˜æ–¹ `to_a2a()` å‡½å¼è¨­å®šçœŸå¯¦çš„ A2A ä¼ºæœå™¨
- ä½¿ç”¨ `RemoteA2aAgent` èˆ‡é ç«¯ä»£ç†é€²è¡Œé€šè¨Š
- é€é `.well-known/agent-card.json` è‡ªå‹•é€²è¡Œä»£ç†æ¢ç´¢
- å°‡å¤šå€‹ä»£ç†ä½œç‚ºç¨ç«‹çš„ `uvicorn` æœå‹™é‹è¡Œ
- ä½¿ç”¨å®˜æ–¹ ADK æ¨¡å¼ä¾†å”èª¿åˆ†æ•£å¼ä»£ç†å·¥ä½œæµç¨‹

**é—œéµæ¦‚å¿µï¼š**
- **RemoteA2aAgent**ï¼šç”¨æ–¼æ¶ˆè²»é ç«¯ A2A ä»£ç†çš„å®˜æ–¹ ADK é¡åˆ¥
- **to_a2a() å‡½å¼**ï¼šç”¨æ–¼é€é A2A å…¬é–‹ä»£ç†çš„å®˜æ–¹ ADK å·¥å…·
- **è‡ªå‹•ç”¢ç”Ÿçš„ä»£ç†å¡ç‰‡ï¼ˆAgent Cardsï¼‰**ï¼šç”± ADK è‡ªå‹•å»ºç«‹çš„ JSON å…ƒæ•¸æ“š
- **uvicorn A2A ä¼ºæœå™¨**ï¼šä½¿ç”¨ `uvicorn + to_a2a()` éƒ¨ç½²çš„ç‰¹åŒ–ä»£ç†
- **å­ä»£ç†æ¨¡å¼ï¼ˆSub-Agent Patternï¼‰**ï¼šç”¨æ–¼ä»£ç†å§”æ´¾çš„å®˜æ–¹ ADK æ¨¡å¼

## æ¶æ§‹

```mermaid
graph TD
    subgraph A["A2A å”èª¿å™¨ (ADK ä»£ç†)"]
        C[RemoteA2a ä»£ç†é¡åˆ¥]
    end
    C -->|RemoteA2aAgent localhost:8001| B[ç ”ç©¶ä»£ç† ADK ä¼ºæœå™¨]
    C -->|RemoteA2aAgent localhost:8002| D[åˆ†æä»£ç† ADK ä¼ºæœå™¨]
    C -->|RemoteA2aAgent localhost:8003| E[å…§å®¹ä»£ç† ADK ä¼ºæœå™¨]
```

## å¿«é€Ÿå…¥é–€

### 1. è¨­å®šç’°å¢ƒ

```bash
# å®‰è£æ‰€æœ‰ä¾è³´å¥—ä»¶ï¼ˆå”èª¿å™¨ + é ç«¯ä»£ç†ï¼‰
make setup

# è¤‡è£½ç’°å¢ƒç¯„æœ¬
cp a2a_orchestrator/.env.example a2a_orchestrator/.env

# ç·¨è¼¯ .env ä¸¦åŠ å…¥æ‚¨çš„ Google API é‡‘é‘°
# GOOGLE_API_KEY=your_actual_api_key_here
```

### 2. å•Ÿå‹•é ç«¯ A2A ä»£ç†

åœ¨ä¸€å€‹çµ‚ç«¯æ©Ÿä¸­ï¼Œä½¿ç”¨å®˜æ–¹ ADK æŒ‡ä»¤å•Ÿå‹•æ‰€æœ‰é ç«¯ A2A ä»£ç†ï¼š

```bash
./start_a2a_servers.sh
```

é€™å°‡æœƒå•Ÿå‹•ï¼š

- ç ”ç©¶ä»£ç†æ–¼ <http://localhost:8001>
- åˆ†æä»£ç†æ–¼ <http://localhost:8002>
- å…§å®¹ä»£ç†æ–¼ <http://localhost:8003>

### 3. å•Ÿå‹•å”èª¿å™¨

åœ¨å¦ä¸€å€‹çµ‚ç«¯æ©Ÿä¸­ï¼Œå•Ÿå‹• ADK é–‹ç™¼ä¼ºæœå™¨ï¼š

```bash
make dev
```

åœ¨æ‚¨çš„ç€è¦½å™¨ä¸­é–‹å•Ÿ <http://localhost:8000> ä¸¦å¾ä»£ç†ä¸‹æ‹‰é¸å–®ä¸­é¸æ“‡ `a2a_orchestrator`ã€‚

### 4. å˜—è©¦ç¯„ä¾‹æŸ¥è©¢

```text
ç ”ç©¶æœ€æ–°çš„é‡å­è¨ˆç®—ç™¼å±•ä¸¦å»ºç«‹ä¸€ä»½æŠ€è¡“æ‘˜è¦
```

```text
åˆ†æé›»å‹•è»Šçš„å¸‚å ´è¶¨å‹¢ä¸¦ç”¢ç”Ÿä¸€ä»½é«˜éšä¸»ç®¡å ±å‘Š
```

## å°ˆæ¡ˆçµæ§‹

```text
tutorial17/
â”œâ”€â”€ a2a_orchestrator/          # ä¸»è¦ ADK ä»£ç†å¥—ä»¶
â”‚   â”œâ”€â”€ __init__.py           # å¥—ä»¶åˆå§‹åŒ–
â”‚   â”œâ”€â”€ agent.py              # å®˜æ–¹ ADK RemoteA2aAgent å¯¦ä½œ
â”‚   â””â”€â”€ .env.example          # ç’°å¢ƒç¯„æœ¬
â”œâ”€â”€ research_agent/           # é ç«¯ç ”ç©¶ä»£ç† (ADK A2A ä¼ºæœå™¨)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent.py              # ä½¿ç”¨ ADK æ¨¡å¼çš„ç ”ç©¶ä»£ç†
â”‚   â””â”€â”€ agent-card.json       # ä»£ç†æ¢ç´¢å¡ç‰‡
â”œâ”€â”€ analysis_agent/           # é ç«¯åˆ†æä»£ç† (ADK A2A ä¼ºæœå™¨)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent.py              # ä½¿ç”¨ ADK æ¨¡å¼çš„åˆ†æä»£ç†
â”‚   â””â”€â”€ agent-card.json       # ä»£ç†æ¢ç´¢å¡ç‰‡
â”œâ”€â”€ content_agent/            # é ç«¯å…§å®¹ä»£ç† (ADK A2A ä¼ºæœå™¨)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent.py              # ä½¿ç”¨ ADK æ¨¡å¼çš„å…§å®¹ä»£ç†
â”‚   â””â”€â”€ agent-card.json       # ä»£ç†æ¢ç´¢å¡ç‰‡
â”œâ”€â”€ tests/                    # æ¸¬è©¦å¥—ä»¶
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_agent.py         # ä»£ç†è¨­å®šæ¸¬è©¦
â”‚   â”œâ”€â”€ test_imports.py       # åŒ¯å…¥é©—è­‰æ¸¬è©¦
â”‚   â””â”€â”€ test_structure.py     # å°ˆæ¡ˆçµæ§‹æ¸¬è©¦
â”œâ”€â”€ start_a2a_servers.sh      # å•Ÿå‹•æ‰€æœ‰ A2A ä¼ºæœå™¨çš„è…³æœ¬
â”œâ”€â”€ stop_a2a_servers.sh       # åœæ­¢æ‰€æœ‰ A2A ä¼ºæœå™¨çš„è…³æœ¬
â”œâ”€â”€ pyproject.toml            # ä¸»è¦å¥—ä»¶è¨­å®š
â”œâ”€â”€ requirements.txt          # ä¾è³´å¥—ä»¶
â”œâ”€â”€ Makefile                 # é–‹ç™¼æŒ‡ä»¤
â””â”€â”€ README.md                # æœ¬æª”æ¡ˆ
```

## ä»£ç†å¯¦ä½œ

### å®˜æ–¹ ADK RemoteA2aAgent è¨­å®š

å”èª¿å™¨ä½¿ç”¨ Google ADK å®˜æ–¹çš„ `RemoteA2aAgent` é¡åˆ¥ä¾†é€£æ¥é ç«¯çš„ç‰¹åŒ–ä»£ç†ï¼š

```python
from google.adk.agents import Agent
from google.adk.agents.remote_a2a_agent import RemoteA2aAgent

# å®˜æ–¹ ADK å­ä»£ç†æ¨¡å¼
root_agent = Agent(
    name="a2a_orchestrator",
    model="gemini-2.0-flash-exp",
    description="å”èª¿èˆ‡é ç«¯ä»£ç†çš„ A2A é€šè¨Š",
    instruction="""æ‚¨èˆ‡ç‰¹åŒ–çš„é ç«¯ä»£ç†å”èª¿...""",
    sub_agents=[
        RemoteA2aAgent(
            name="research_agent",
            base_url="http://localhost:8001"
        ),
        RemoteA2aAgent(
            name="analysis_agent",
            base_url="http://localhost:8002"
        ),
        RemoteA2aAgent(
            name="content_agent",
            base_url="http://localhost:8003"
        ),
    ]
)
```

### å®˜æ–¹ ADK A2A é€šè¨Šæµç¨‹

1. **ä»£ç†æ¢ç´¢**ï¼šå”èª¿å™¨ä½¿ç”¨å¸¶æœ‰åŸºç¤ URL çš„ `RemoteA2aAgent`
2. **å­ä»£ç†æ¨¡å¼**ï¼š`RemoteA2aAgent` è‡ªå‹•è™•ç†é€šè¨Š
3. **è¨Šæ¯å§”æ´¾**ï¼šå”èª¿å™¨å°‡ä»»å‹™å§”æ´¾çµ¦é©ç•¶çš„å­ä»£ç†
4. **å›æ‡‰è™•ç†**ï¼šADK è‡ªå‹•è™•ç†æ‰€æœ‰å”å®šç´°ç¯€
5. **é€£ç·šç®¡ç†**ï¼šADK ç®¡ç† HTTP å®¢æˆ¶ç«¯èˆ‡é€£ç·š

### å•Ÿå‹•é ç«¯ A2A ä¼ºæœå™¨

æ¯å€‹é ç«¯ä»£ç†éƒ½ä½¿ç”¨å®˜æ–¹ ADK çš„ `to_a2a()` å‡½å¼èˆ‡ `uvicorn` ä¾†é‹è¡Œï¼š

```bash
# å•Ÿå‹•æ‰€æœ‰ä¼ºæœå™¨
./start_a2a_servers.sh

# å–®ç¨å•Ÿå‹•ä¼ºæœå™¨ï¼ˆè…³æœ¬æ‰€åšçš„äº‹æƒ…ï¼‰ï¼š
uvicorn research_agent.agent:a2a_app --host localhost --port 8001
uvicorn analysis_agent.agent:a2a_app --host localhost --port 8002
uvicorn content_agent.agent:a2a_app --host localhost --port 8003
```

é ç«¯ä»£ç†æœƒè‡ªå‹•å…¬é–‹ï¼š

- ä½æ–¼ `http://localhost:{port}/.well-known/agent-card.json` çš„è‡ªå‹•ç”¢ç”Ÿä»£ç†å¡ç‰‡
- ç”¨æ–¼ä»»å‹™åŸ·è¡Œçš„ A2A ç«¯é»
- å¥åº·æª¢æŸ¥èˆ‡æœå‹™æ¢ç´¢

## å®˜æ–¹ ADK A2A å”å®šç´°ç¯€

### ä»£ç†æ¢ç´¢

é ç«¯ä»£ç†ä½¿ç”¨å®˜æ–¹ `to_a2a()` å‡½å¼åœ¨ `/.well-known/agent-card.json` å…¬é–‹**è‡ªå‹•ç”¢ç”Ÿçš„ä»£ç†å¡ç‰‡**ï¼š

```json
{
  "name": "research_specialist",
  "description": "é€²è¡Œç¶²è·¯ç ”ç©¶èˆ‡äº‹å¯¦æŸ¥æ ¸",
  "capabilities": {},
  "skills": [
    {
      "name": "research_topic",
      "description": "ç ”ç©¶ç‰¹å®šä¸»é¡Œä¸¦æä¾›è©³ç´°çš„ç™¼ç¾"
    }
  ],
  "url": "http://localhost:8001"
}
```

### to_a2a() å‡½å¼çš„å¥½è™•

- **è‡ªå‹•ç”¢ç”Ÿçš„å¡ç‰‡**ï¼šå¾ä»£ç†ç¨‹å¼ç¢¼è‡ªå‹•å»ºç«‹ä»£ç†å¡ç‰‡
- **å”å®šè™•ç†**ï¼šæ‰€æœ‰ A2A å”å®šç´°ç¯€ç”± ADK è™•ç†
- **ç°¡æ˜“éƒ¨ç½²**ï¼šç°¡å–®çš„ `uvicorn + to_a2a()` æ¨¡å¼
- **é¡å‹å®‰å…¨**ï¼šå®Œæ•´çš„ TypeScript/Python é¡å‹å®šç¾©

## æ¸¬è©¦

åŸ·è¡Œå…¨é¢çš„æ¸¬è©¦å¥—ä»¶ï¼š

```bash
make test
```

æ¸¬è©¦æ¶µè“‹ï¼š

- ä»£ç†è¨­å®šèˆ‡åˆå§‹åŒ–
- å·¥å…·åŠŸèƒ½
- åŒ¯å…¥é©—è­‰
- å°ˆæ¡ˆçµæ§‹åˆè¦æ€§

## å±•ç¤ºæ¨¡å¼

æŸ¥çœ‹ç¯„ä¾‹ç”¨æ³•èˆ‡åŠŸèƒ½ï¼š

```bash
make demo
```

## ç’°å¢ƒè®Šæ•¸

| è®Šæ•¸ | æè¿° | å¿…è¦ |
|----------|-------------|----------|
| `GOOGLE_API_KEY` | Google AI Studio API é‡‘é‘° | æ˜¯ |

## ç–‘é›£æ’è§£

### å¸¸è¦‹å•é¡Œ

#### æ‰¾ä¸åˆ°ä»£ç†å¡ç‰‡

- é ç«¯ä»£ç†æœªéƒ¨ç½²æˆ–æœªå…¬é–‹ `/.well-known/agent-card.json`
- æª¢æŸ¥ç¶²è·¯é€£ç·šèˆ‡ä»£ç† URL

#### é©—è­‰å¤±æ•—

- ç¼ºå°‘æˆ–ç„¡æ•ˆçš„é©—è­‰æ¬Šæ–
- é©—è­‰æ¬Šæ–æ ¼å¼èˆ‡æ¬Šé™

#### é€£ç·šé€¾æ™‚

- ç¶²è·¯å•é¡Œæˆ–é ç«¯ä»£ç†ä¸å¯ç”¨
- æª¢æŸ¥ä»£ç†ç‹€æ…‹ä¸¦é‡è©¦

### é–‹ç™¼æç¤º

- ä½¿ç”¨ `./start_a2a_servers.sh` å•Ÿå‹•æ‰€æœ‰ä»£ç†ä¸¦é€²è¡Œé©ç•¶çš„å¥åº·æª¢æŸ¥
- åœ¨ `http://localhost:800x/.well-known/agent-card.json` æª¢æŸ¥ä»£ç†å¡ç‰‡
- ç›£æ§æ—¥èªŒä»¥é€²è¡Œå”èª¿é™¤éŒ¯

## ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²

ä½¿ç”¨å®˜æ–¹ ADK éƒ¨ç½²æŒ‡ä»¤èˆ‡ `to_a2a()` æ¨¡å¼ï¼š

```bash
# éƒ¨ç½²å”èª¿å™¨
adk deploy cloud_run a2a_orchestrator/

# ä½¿ç”¨ uvicorn + to_a2a() éƒ¨ç½²é ç«¯ä»£ç†
# (ç”¨æ–¼ç”Ÿç”¢ A2A ä¼ºæœå™¨çš„è‡ªè¨‚éƒ¨ç½²)
```

## å¾ŒçºŒæ­¥é©Ÿ

- **æ•™å­¸ 18**ï¼šäº‹ä»¶èˆ‡å¯è§€å¯Ÿæ€§
- **æ•™å­¸ 19**ï¼šç”¢ç‰©èˆ‡æª”æ¡ˆç®¡ç†
- **æ•™å­¸ 20**ï¼šYAML è¨­å®š

## è³‡æº

- [Google ADK æ–‡ä»¶](https://google.github.io/adk-docs/)
- [RemoteA2aAgent API](https://google.github.io/adk-docs/api/remote-a2a-agent/)
- [A2A å”å®šæŒ‡å—](https://google.github.io/adk-docs/a2a/)

---

**ğŸ‰ æ•™å­¸ 17 å®Œæˆï¼** æ‚¨ç¾åœ¨äº†è§£å¦‚ä½•ä½¿ç”¨å®˜æ–¹ ADK A2A é€šè¨Šä¾†å»ºæ§‹åˆ†æ•£å¼å¤šä»£ç†ç³»çµ±ã€‚
