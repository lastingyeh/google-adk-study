# 詳細測試案例範本

## 簡介

此文件提供了一個詳細的測試案例範本，旨在為專案建立清晰、一致且全面的測試文件。使用此範本可以幫助開發者和測試人員標準化測試流程，確保所有關鍵功能都得到充分的驗證。

## 代理基礎功能測試 (`tests/integration/test_agent.py`)

此部分涵蓋對代理基礎回應能力的測試。

| 群組 | 測試案例編號 | 描述 | 前置條件 | 測試步驟 | 測試數據 | 預期結果 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **基礎回應** | **TC-AGENT-001** | 檢查代理是否能成功回應問候語 | Runner 已初始化 | 1. 準備輸入 "hi"<br>2. 調用代理並等待回應 | question="hi" | 收到包含文字內容的事件回應 |

## 對話流程測試 (`tests/integration/test_conversational_flow.py`)

此部分涵蓋對代理多輪對話及策略建立流程的測試。

| 群組 | 測試案例編號 | 描述 | 前置條件 | 測試步驟 | 測試數據 | 預期結果 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **策略建立流程** | **TC-FLOW-001** | 測試多輪對話：從 GCS 建立並執行策略 | 代理與模擬工具已初始化 | 1. 用戶詢問建立策略<br>2. 用戶指定來源為 GCS<br>3. 用戶提供 GCS URI | 1. "I want to check..."<br>2. "Use GCS"<br>3. "gs://..." | 代理依序執行尋找、生成、儲存、執行，並報告模擬的違規結果 |

## 記分卡流程測試 (`tests/integration/test_scorecard_flow.py`)

此部分涵蓋對合規記分卡生成流程的測試。

| 群組 | 測試案例編號 | 描述 | 前置條件 | 測試步驟 | 測試數據 | 預期結果 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **記分卡生成** | **TC-SCORE-001** | 測試生成合規記分卡的對話流程 | 代理與模擬工具已初始化 | 1. 用戶要求生成記分卡 | "Generate a compliance scorecard..." | 回應包含合規分數 (100.0%) 及策略詳情 |

## 伺服器端對端測試 (`tests/integration/test_server_e2e.py`)

此部分涵蓋對 FastAPI 伺服器端點的整合測試。

| 群組 | 測試案例編號 | 描述 | 前置條件 | 測試步驟 | 測試數據 | 預期結果 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **聊天串流** | **TC-SERVER-001** | 測試聊天串流功能 | 伺服器已啟動 | 1. 建立使用者工作階段<br>2. 發送聊天訊息請求 (streaming=True) | message="Hi!" | 接收到 SSE 事件流，且包含文字內容 |
| **錯誤處理** | **TC-SERVER-002** | 測試聊天串流錯誤處理 | 伺服器已啟動 | 1. 發送格式錯誤的請求 | Invalid Payload | 伺服器返回 422 錯誤代碼 |
| **回饋收集** | **TC-SERVER-003** | 測試回饋收集端點 | 伺服器已啟動 | 1. 發送回饋資料至 /feedback | score=4, text="Great response!" | 伺服器返回 200 成功狀態碼 |
