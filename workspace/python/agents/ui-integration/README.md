# æ•™å­¸ 29ï¼šUI æ•´åˆä»‹ç´¹ - å¿«é€Ÿå…¥é–€

é€™æ˜¯ä¸€å€‹æœ€å°åŒ–çš„å¯¦ä½œï¼Œç¤ºç¯„å¦‚ä½•ä½¿ç”¨ AG-UI å”å®š (AG-UI Protocol) å°‡ ADK ä»£ç†èˆ‡ React UI æ•´åˆã€‚æ­¤ç‚ºæ•™å­¸ 29 ä¸­çš„å¿«é€Ÿå…¥é–€ç¯„ä¾‹ã€‚

## ğŸš€ å¿«é€Ÿå…¥é–€

```bash
# 1. å®‰è£ä¾è³´é …
make setup

# 2. è¨­å®š API é‡‘é‘°
cp agent/.env.example agent/.env
# ç·¨è¼¯ agent/.env ä¸¦åŠ å…¥æ‚¨çš„ GOOGLE_API_KEY

# 3. å•Ÿå‹•å¾Œç«¯èˆ‡å‰ç«¯
make dev

# 4. åœ¨ç€è¦½å™¨ä¸­é–‹å•Ÿ http://localhost:5173
```

## ğŸ“‹ å…§å®¹åŒ…å«

é€™å€‹æœ€å°åŒ–å¯¦ä½œåŒ…å«ï¼š

- âœ… **Python ADK ä»£ç†** - ç°¡å–®çš„å°è©±å¼åŠ©ç†
- âœ… **FastAPI å¾Œç«¯** èˆ‡ AG-UI æ•´åˆ
- âœ… **React + Vite å‰ç«¯** èˆ‡ CopilotKit
- âœ… **å³æ™‚èŠå¤©ä»‹é¢** æ”¯æ´ä¸²æµ
- âœ… **å®Œæ•´çš„æ¸¬è©¦å¥—ä»¶** (è¶…é 15 å€‹æ¸¬è©¦)
- âœ… **å¿«é€Ÿè¨­å®š** (å°‘æ–¼ 10 åˆ†é˜)

## ğŸ—ï¸ æ¶æ§‹

```mermaid
sequenceDiagram
    autonumber

    participant U as ä½¿ç”¨è€…ç€è¦½å™¨<br/>React + Vite App <br/>(Port 5173)

    box rgba(242, 251, 223, 1) Backend System
    participant F as å¾Œç«¯ä¼ºæœå™¨<br/>FastAPI + ag_ui_adk<br/>(Port 8000)
    participant A as ADK Agent<br/>Google ADK
    end

    participant G as Gemini API<br/>Gemini 2.0 Flash

    %% === Step 1: Browser â†’ Backend ===
    U->>F: ç™¼é€ AG-UI Protocol è«‹æ±‚ (HTTP / SSE)<br/>åŒ…å«ä½¿ç”¨è€…è¨Šæ¯èˆ‡ Session ID

    %% === Step 2: Backendè™•ç† ===
    F->>F: AG-UI Adapter è§£æè«‹æ±‚<br/>Session ç®¡ç†è¼‰å…¥ / æ›´æ–°ä¸Šä¸‹æ–‡

    %% === Step 3: Backend â†’ ADK Agent ===
    F->>A: å‘¼å« ADK Agent<br/>å‚³å…¥ modelã€toolsã€instruction<br/>å‚³å…¥ conversation context

    %% === Step 4: ADK Agent â†’ Gemini API ===
    A->>G: å‘¼å« Gemini æ¨¡å‹ API<br/>model: gemini-2.0-flash-exp<br/>é€å‡º prompt

    %% === Step 5: Gemini å›å‚³ Token ===
    G-->>A: ä¸²æµå¼ Token å›æ‡‰<br/>(æ–‡å­—ç”Ÿæˆ / é€å­—è¼¸å‡º)

    %% === Step 6: ADK Agent â†’ Backend ===
    A-->>F: å›å‚³ä¸²æµ tokens<br/>ä¸¦ç”¢ç”Ÿå°è©±å›è¦†å…§å®¹

    %% === Step 7: Backend â†’ Browser ===
    F-->>U: SSE ä¸²æµå›å‚³è‡³å‰ç«¯<br/>æ›´æ–° <CopilotChat> UI

    %% === Step 8: Browser UI æ›´æ–° ===
    U->>U: React UI é€æ­¥æ¸²æŸ“<br/>ä½¿ç”¨ copilotkit/react-core
```

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
ui-integration/
â”œâ”€â”€ agent/                      # Python å¾Œç«¯
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent.py               # ADK ä»£ç† + FastAPI æ‡‰ç”¨ç¨‹å¼
â”‚   â””â”€â”€ .env.example           # ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
â”œâ”€â”€ frontend/                  # React å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.tsx            # ä½¿ç”¨ CopilotKit çš„ä¸»è¦æ‡‰ç”¨ç¨‹å¼
â”‚   â”‚   â”œâ”€â”€ App.css            # æ¨£å¼
â”‚   â”‚   â””â”€â”€ main.tsx           # é€²å…¥é»
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ tests/                     # æ¸¬è©¦å¥—ä»¶
â”‚   â”œâ”€â”€ test_imports.py        # åŒ¯å…¥æ¸¬è©¦
â”‚   â”œâ”€â”€ test_structure.py      # çµæ§‹æ¸¬è©¦
â”‚   â””â”€â”€ test_agent.py          # ä»£ç†æ¸¬è©¦
â”œâ”€â”€ Makefile                   # å»ºç½®æŒ‡ä»¤
â”œâ”€â”€ requirements.txt           # Python ä¾è³´é …
â”œâ”€â”€ pyproject.toml            # Python å°ˆæ¡ˆè¨­å®š
â””â”€â”€ README.md                  # æœ¬æª”æ¡ˆ
```

## ğŸ¯ æ‚¨å°‡å­¸åˆ°ä»€éº¼

æ­¤å¯¦ä½œå±•ç¤ºäº† UI Integration çš„æ ¸å¿ƒæ¦‚å¿µï¼š

1. **AG-UI å”å®šæ•´åˆ** - å¦‚ä½•å°‡ ADK ä»£ç†é€£æ¥åˆ° React UI
2. **æœ€å°åŒ–è¨­å®š** - æœ€ç°¡å–®çš„å¯è¡Œç¯„ä¾‹
3. **å¾Œç«¯æ¶æ§‹** - FastAPI + ag_ui_adk æ¨¡å¼
4. **å‰ç«¯æ¶æ§‹** - React + CopilotKit æ¨¡å¼
5. **é–‹ç™¼å·¥ä½œæµç¨‹** - å¾è¨­å®šåˆ°é‹è¡Œæ‡‰ç”¨ç¨‹å¼

## ğŸ’¬ å˜—è©¦é€™äº›æç¤º

æ‡‰ç”¨ç¨‹å¼é‹è¡Œå¾Œï¼Œè«‹å˜—è©¦ï¼š

- "ä»€éº¼æ˜¯ Google ADKï¼Ÿ"
- "AG-UI å”å®šå¦‚ä½•é‹ä½œï¼Ÿ"
- "è§£é‡‹ UI æ•´åˆçš„å„ªé»"
- "ä½ èƒ½å¹«æˆ‘åšä»€éº¼ï¼Ÿ"
- "å‘Šè¨´æˆ‘ä¸åŒçš„ UI æ•´åˆæ–¹æ³•"

## ğŸ§ª æ¸¬è©¦

```bash
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
make test

# æ¸¬è©¦é©—è­‰ï¼š
# - æ‰€æœ‰åŒ¯å…¥æ˜¯å¦æ­£å¸¸
# - å°ˆæ¡ˆçµæ§‹æ˜¯å¦æ­£ç¢º
# - ä»£ç†æ˜¯å¦å·²æ­£ç¢ºè¨­å®š
# - FastAPI æ‡‰ç”¨ç¨‹å¼æ˜¯å¦å·²æ­£ç¢ºè¨­å®š
# - AG-UI æ•´åˆæ˜¯å¦æ­£å¸¸é‹ä½œ
```

## ğŸ› æ•…éšœæ’é™¤

### å¾Œç«¯ç„¡æ³•å•Ÿå‹•

```bash
# æª¢æŸ¥ API é‡‘é‘°æ˜¯å¦å·²è¨­å®š
echo $GOOGLE_API_KEY

# è‹¥æœªè¨­å®šï¼Œè«‹é€²è¡Œè¨­å®š
cp agent/.env.example agent/.env
# ç·¨è¼¯ agent/.env ä¸¦å¡«å…¥æ‚¨çš„ API é‡‘é‘°
export GOOGLE_API_KEY=your_key_here
```

### å‰ç«¯ç„¡æ³•é€£æ¥åˆ°å¾Œç«¯

1. ç¢ºèªå¾Œç«¯æ­£åœ¨åŸ è™Ÿ 8000 ä¸Šé‹è¡Œ
2. æª¢æŸ¥ `agent/agent.py` ä¸­æ˜¯å¦å·²å•Ÿç”¨ CORS
3. ç¢ºèªå‰ç«¯çš„ `runtimeUrl` èˆ‡å¾Œç«¯ URL ç›¸ç¬¦

### "ag_ui_adk not found" éŒ¯èª¤

```bash
# å®‰è£ AG-UI ADK å¥—ä»¶
pip install ag-ui-adk
```

### æ¸¬è©¦å¤±æ•—

```bash
# ç¢ºä¿æ‚¨ä½æ–¼ tutorial29 ç›®éŒ„ä¸­
cd tutorial_implementation/tutorial29

# é¦–å…ˆåŸ·è¡Œè¨­å®š
make setup

# ç„¶å¾ŒåŸ·è¡Œæ¸¬è©¦
make test
```

## ğŸ“š äº†è§£æ›´å¤š

é€™æ˜¯ä¸€å€‹æœ€å°åŒ–çš„å¿«é€Ÿå…¥é–€ç¯„ä¾‹ã€‚å¦‚éœ€æ›´é€²éšçš„åŠŸèƒ½ï¼Œè«‹åƒé–±ï¼š

- **æ•™å­¸ 30**ï¼šNext.js + ADKï¼ŒåŒ…å«å·¥å…·èˆ‡é€²éšåŠŸèƒ½
- **æ•™å­¸ 31**ï¼šReact Vite + ADKï¼ŒåŒ…å«æ›´è¤‡é›œçš„ç¯„ä¾‹
- **æ•™å­¸ 32**ï¼šStreamlit ç›´æ¥æ•´åˆ
- **æ•™å­¸ 33**ï¼šSlack æ©Ÿå™¨äººæ•´åˆ

## ğŸ”‘ èˆ‡æ•™å­¸ 30 çš„ä¸»è¦å·®ç•°

æ•™å­¸ 29 (æœ¬ç¯‡)ï¼š
- ç”¨æ–¼å­¸ç¿’çš„æœ€å°åŒ–ç¯„ä¾‹
- ç„¡è‡ªè¨‚å·¥å…· (åƒ…å°è©±)
- Vite + React (è¼ƒç°¡å–®)
- è‘—é‡æ–¼æ•´åˆæ¨¡å¼

æ•™å­¸ 30ï¼š
- å¯ç”¨æ–¼ç”Ÿç”¢ç’°å¢ƒçš„ç¯„ä¾‹
- å¤šå€‹è‡ªè¨‚å·¥å…·
- Next.js 15 (æ›´å¤šåŠŸèƒ½)
- é€²éšåŠŸèƒ½ (ç”Ÿæˆå¼ UIã€äººæ©Ÿå›åœˆ (HITL)ã€å…±äº«ç‹€æ…‹)

## ğŸ‰ ä¸‹ä¸€æ­¥æ˜¯ä»€éº¼ï¼Ÿ

ç¾åœ¨æ‚¨å·²äº†è§£åŸºç¤çŸ¥è­˜ï¼š

1. âœ… æ‚¨å·²äº†è§£ AG-UI å”å®šçš„é‹ä½œæ–¹å¼
2. âœ… æ‚¨å·²äº†è§£å¾Œç«¯/å‰ç«¯æ¶æ§‹
3. âœ… æ‚¨å¯ä»¥è¨­å®šä¸¦é‹è¡Œæ­¤æ•´åˆ

**å¾ŒçºŒæ­¥é©Ÿ**ï¼š
- ç‚ºä»£ç†æ–°å¢è‡ªè¨‚å·¥å…· (è«‹åƒé–±æ•™å­¸ 30)
- éƒ¨ç½²è‡³ç”Ÿç”¢ç’°å¢ƒ (Cloud Run + Vercel)
- å¯¦ä½œé€²éšåŠŸèƒ½ (ç”Ÿæˆå¼ UIã€äººæ©Ÿå›åœˆ)
- å˜—è©¦å…¶ä»–æ•´åˆæ–¹æ³• (Streamlitã€Slack)

## ğŸ“ å‚™è¨»

- æœ¬å…§å®¹åŸºæ–¼æ•™å­¸ 29 çš„å¿«é€Ÿå…¥é–€éƒ¨åˆ†
- ä½¿ç”¨èˆ‡æ•™å­¸æ–‡ä»¶å®Œå…¨ç›¸åŒçš„æ¨¡å¼
- æ‰€æœ‰ç¨‹å¼ç¢¼å‡ä½¿ç”¨æ­£ç¢ºçš„ ADK v1.16+ Runner API æ¨¡å¼
- å·²é©—è­‰å¯èˆ‡æœ€æ–°ç‰ˆæœ¬çš„ ADK å’Œ CopilotKit é…åˆä½¿ç”¨

---

**æœ‰ä»»ä½•å•é¡Œæˆ–å›é¥‹ï¼Ÿ** è«‹åœ¨ [ADK è¨“ç·´å„²å­˜åº«](https://github.com/raphaelmansuy/adk-training) æäº¤å•é¡Œ (issue)ã€‚

### é‡é»æ‘˜è¦
- **æ ¸å¿ƒæ¦‚å¿µ**ï¼šæœ¬æ–‡ä»¶æ˜¯ä¸€å€‹å¿«é€Ÿå…¥é–€æŒ‡å—ï¼Œèªªæ˜å¦‚ä½•é€é **AG-UI å”å®š** å°‡ä¸€å€‹åŸºæ–¼ **Google ADK** çš„ Python ä»£ç†èˆ‡ä¸€å€‹ **React** å‰ç«¯é€²è¡Œæœ€å°åŒ–çš„æ•´åˆã€‚
- **é—œéµæŠ€è¡“**ï¼š
    - **Google ADK (Agent Development Kit)**ï¼šç”¨æ–¼å»ºæ§‹ AI ä»£ç†çš„æ¡†æ¶ã€‚
    - **React (with Vite)**ï¼šç”¨æ–¼å»ºæ§‹ä½¿ç”¨è€…ä»‹é¢çš„å‰ç«¯å‡½å¼åº«ã€‚
    - **FastAPI**ï¼šä¸€å€‹é«˜æ•ˆèƒ½çš„ Python Web æ¡†æ¶ï¼Œç”¨æ–¼å»ºæ§‹å¾Œç«¯ APIã€‚
    - **CopilotKit**ï¼šä¸€å€‹å‰ç«¯å·¥å…·ï¼Œå¯è¼•é¬†å°‡ AI èŠå¤©åŠŸèƒ½æ•´åˆè‡³ React æ‡‰ç”¨ç¨‹å¼ã€‚
    - **AG-UI å”å®š**ï¼šä¸€å€‹å°ˆç‚ºä»£ç†èˆ‡ UI ä¹‹é–“é€šè¨Šè¨­è¨ˆçš„å”å®šï¼Œæ”¯æ´ HTTP/SSE (Server-Sent Events) ä»¥å¯¦ç¾å³æ™‚ä¸²æµã€‚
- **å°ˆæ¡ˆæ¶æ§‹**ï¼š
    - **å‰ç«¯** (`frontend/`)ï¼šä¸€å€‹ React + Vite æ‡‰ç”¨ç¨‹å¼ï¼Œé‹è¡Œæ–¼åŸ è™Ÿ 5173ï¼Œä½¿ç”¨ CopilotKit å»ºç«‹èŠå¤©ä»‹é¢ã€‚
    - **å¾Œç«¯** (`agent/`)ï¼šä¸€å€‹ FastAPI ä¼ºæœå™¨ï¼Œé‹è¡Œæ–¼åŸ è™Ÿ 8000ï¼Œè² è²¬è¨—ç®¡ ADK ä»£ç†ä¸¦é€é `/api/copilotkit` ç«¯é»èˆ‡å‰ç«¯é€šè¨Šã€‚
    - **æ¨¡å‹**ï¼šä½¿ç”¨ `gemini-2.0-flash-exp` ä½œç‚ºåº•å±¤èªè¨€æ¨¡å‹ã€‚
- **è¡Œå‹•é …ç›®**ï¼š
    - ä½¿ç”¨ `make setup` å®‰è£æ‰€æœ‰ä¾è³´é …ã€‚
    - åœ¨ `agent/.env` ä¸­è¨­å®š `GOOGLE_API_KEY`ã€‚
    - åŸ·è¡Œ `make dev` ä¾†åŒæ™‚å•Ÿå‹•å‰å¾Œç«¯ä¼ºæœå™¨ã€‚
    - åœ¨ç€è¦½å™¨ä¸­é–‹å•Ÿ `http://localhost:5173` ä¾†èˆ‡ AI ä»£ç†äº’å‹•ã€‚

### Mermaid æµç¨‹åœ–
```mermaid
sequenceDiagram
    participant User as ä½¿ç”¨è€…
    participant Frontend as ç€è¦½å™¨ (React UI)
    participant Backend as å¾Œç«¯ (FastAPI + ADK)
    participant Gemini as Gemini æ¨¡å‹

    User->>Frontend: 1. è¼¸å…¥è¨Šæ¯
    Frontend->>Backend: 2. å‚³é€è«‹æ±‚ (AG-UI å”å®š)
    Backend->>Gemini: 3. å‘¼å« Gemini API
    Gemini-->>Backend: 4. ä¸²æµå›æ‡‰
    Backend-->>Frontend: 5. é€é SSE ä¸²æµå‚³å›
    Frontend-->>User: 6. å³æ™‚é¡¯ç¤ºå›æ‡‰
```