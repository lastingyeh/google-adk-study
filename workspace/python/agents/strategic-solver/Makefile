# ç­–ç•¥å•é¡Œè§£æ±ºå™¨ - æ•™å­¸ 12ï¼šè¦åŠƒå™¨èˆ‡æ€è€ƒé…ç½®
# ç”¨æ–¼é–‹ç™¼ã€æ¸¬è©¦å’Œéƒ¨ç½²çš„ Makefile

.PHONY: help setup dev test demo examples clean lint format

# é è¨­ç›®æ¨™
help:
	@echo "ç­–ç•¥å•é¡Œè§£æ±ºå™¨ - æ•™å­¸ 12"
	@echo ""
	@echo "å¯ç”¨æŒ‡ä»¤ï¼š"
	@echo "  setup     å®‰è£ç›¸ä¾å¥—ä»¶ä¸¦ä»¥é–‹ç™¼æ¨¡å¼å®‰è£å¥—ä»¶"
	@echo "  dev       å•Ÿå‹• ADK ç¶²é ä»‹é¢ (http://localhost:8000)"
	@echo "  test      åŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶ (60+ å€‹æ¸¬è©¦)"
	@echo "  demo      åŸ·è¡Œè‡ªå‹•åŒ–ç­–ç•¥å•é¡Œè§£æ±ºç¯„ä¾‹"
	@echo "  examples  é¡¯ç¤ºå¯æ¸¬è©¦çš„ç¯„ä¾‹æŸ¥è©¢"
	@echo "  clean     ç§»é™¤å¿«å–æª”æ¡ˆå’Œç”¢å‡ºç‰©"
	@echo "  lint      ä½¿ç”¨ flake8 æª¢æŸ¥ç¨‹å¼ç¢¼é¢¨æ ¼"
	@echo "  format    ä½¿ç”¨ black æ ¼å¼åŒ–ç¨‹å¼ç¢¼"

# è¨­å®šç’°å¢ƒ
setup:
	pip install -r requirements.txt
	pip install -e .[dev]

# å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
dev:
	@echo "æ­£åœ¨å•Ÿå‹• ADK ç¶²é ä»‹é¢..."
	@echo "åœ¨ç€è¦½å™¨é–‹å•Ÿ http://localhost:8000"
	@echo "å¾ä»£ç†ä¸‹æ‹‰é¸å–®é¸æ“‡ 'strategic_solver'"
	adk web

# åŸ·è¡Œæ¸¬è©¦
test:
	pytest tests/ -v --cov=strategic_solver --cov-report=term-missing

# åŸ·è¡Œç¤ºç¯„ç¯„ä¾‹
demo:
	@echo "åŸ·è¡Œç­–ç•¥å•é¡Œè§£æ±ºç¯„ä¾‹..."
	@echo "é€™å°‡å±•ç¤ºä¸‰ç¨®è¦åŠƒå™¨é¡å‹ (BuiltInPlanner, PlanReActPlanner, StrategicPlanner)"
	@echo "è™•ç†ä¸åŒçš„å•†æ¥­å ´æ™¯ã€‚"
	@echo ""
	python -c "import asyncio; from strategic_solver.agent import demo_strategic_planning; asyncio.run(demo_strategic_planning())"

# é¡¯ç¤ºæ¸¬è©¦ç¯„ä¾‹æŸ¥è©¢
examples:
	@echo "ç­–ç•¥å•é¡Œè§£æ±ºå™¨ - æ¸¬è©¦ç¯„ä¾‹æŸ¥è©¢"
	@echo "=================================================="
	@echo ""
	@echo "åœ¨ ADK ç¶²é ä»‹é¢ (make dev) æˆ–ä»£ç†ä¸­å˜—è©¦é€™äº›æŸ¥è©¢ï¼š"
	@echo ""
	@echo "ğŸ“Š å¸‚å ´åˆ†ææŸ¥è©¢ï¼š"
	@echo "  â€¢ æˆ‘å€‘æ‡‰è©²æ“´å±•åˆ°äºæ´²é†«ç™‚ä¿å¥å¸‚å ´å—ï¼Ÿ"
	@echo "  â€¢ æ­æ´²é‡‘èç§‘æŠ€é ˜åŸŸå€¼å¾—é€²å…¥å—ï¼Ÿ"
	@echo "  â€¢ åˆ†æ AI è«®è©¢æœå‹™çš„å¸‚å ´æ©Ÿæœƒ"
	@echo ""
	@echo "ğŸ’° è²¡å‹™åˆ†ææŸ¥è©¢ï¼š"
	@echo '  â€¢ æˆ‘å€‘æ‡‰è©²æŠ•è³‡ 200 è¬ç¾å…ƒåœ¨å†ç”Ÿèƒ½æºæ–°å‰µå…¬å¸å—ï¼Ÿ'
	@echo '  â€¢ é€™é … 50 è¬ç¾å…ƒçš„ AI æŠ€è¡“æŠ•è³‡å€¼å¾—å†’éšªå—ï¼Ÿ'
	@echo "  â€¢ è¨ˆç®— 3 å¹´æœŸæŠ•è³‡ 15% å¹´å ±é…¬ç‡çš„ ROI"
	@echo ""
	@echo "âš ï¸  é¢¨éšªè©•ä¼°æŸ¥è©¢ï¼š"
	@echo "  â€¢ æˆ‘å€‘æ‡‰è©²å¦‚ä½•æ¸›è¼•é‡‘èç§‘æŠ€æ–°å‰µå…¬å¸çš„ç¶²è·¯å®‰å…¨å¨è„…ï¼Ÿ"
	@echo "  â€¢ é€²å…¥æ­æ´²å¸‚å ´æœ‰å“ªäº›é¢¨éšªï¼Ÿ"
	@echo "  â€¢ è©•ä¼°æ–°ç”¢å“ç™¼å¸ƒçš„å•†æ¥­é¢¨éšª"
	@echo ""
	@echo "ğŸ¯ ç­–ç•¥è¦åŠƒæŸ¥è©¢ï¼š"
	@echo '  â€¢ æˆ‘å€‘æœ‰ 100 è¬ç¾å…ƒå¯æŠ•è³‡ - æ‡‰è©²æ“´å±•ç¾æœ‰æ¥­å‹™é‚„æ˜¯é€²å…¥æ–°å¸‚å ´ï¼Ÿ'
	@echo "  â€¢ ç‚ºæˆ‘å€‘çš„ SaaS å…¬å¸è¨­è¨ˆ 5 å¹´æˆé•·ç­–ç•¥"
	@echo "  â€¢ æˆ‘å€‘æ‡‰è©²å¦‚ä½•æ‡‰å°æ—¥ç›Šæ¿€çƒˆçš„å¸‚å ´ç«¶çˆ­ï¼Ÿ"
	@echo ""
	@echo "ğŸ¤– è¦åŠƒå™¨æ¯”è¼ƒï¼š"
	@echo "  æ¯å€‹ä»£ç†ä½¿ç”¨ä¸åŒçš„è¦åŠƒæ–¹æ³•ï¼š"
	@echo "  â€¢ BuiltInPlanner: é¡¯ç¤ºé€æ˜çš„æ€è€ƒéç¨‹"
	@echo "  â€¢ PlanReActPlanner: ä½¿ç”¨çµæ§‹åŒ–çš„ è¨ˆåŠƒâ†’æ¨ç†â†’è¡Œå‹•â†’è§€å¯Ÿâ†’é‡æ–°è¦åŠƒ"
	@echo "  â€¢ StrategicPlanner: ç‰¹å®šé ˜åŸŸçš„å•†æ¥­ç­–ç•¥å·¥ä½œæµç¨‹"
	@echo ""
	@echo "ğŸ’¡ æç¤ºï¼š"
	@echo "  â€¢ è¤‡é›œæŸ¥è©¢æ¯”ç°¡å–®æŸ¥è©¢æ›´é©åˆä½¿ç”¨è¦åŠƒå™¨"
	@echo "  â€¢ BuiltInPlanner é¡¯ç¤ºæ¨ç†éç¨‹ - éå¸¸é©åˆå­¸ç¿’"
	@echo "  â€¢ PlanReActPlanner ç³»çµ±åŒ–ä¸”å¾¹åº•"
	@echo "  â€¢ StrategicPlanner éµå¾ªå•†æ¥­è«®è©¢æ–¹æ³•è«–"

# æ¸…ç†
clean:
	find . -type d -name __pycache__ -exec rm -rf {} +
	find . -type f -name "*.pyc" -delete
	find . -type f -name "*.pyo" -delete
	find . -type f -name "*.pyd" -delete
	find . -type f -name ".coverage" -delete
	find . -type d -name "*.egg-info" -exec rm -rf {} +
	find . -type d -name ".pytest_cache" -exec rm -rf {} +

# ç¨‹å¼ç¢¼å“è³ª
lint:
	flake8 strategic_solver/ tests/
	black --check strategic_solver/ tests/

format:
	black strategic_solver/ tests/