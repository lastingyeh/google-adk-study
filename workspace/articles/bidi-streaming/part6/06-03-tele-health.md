歡迎來到這堂深度技術實戰課。我是你們的資深技術導師。

在討論過電商導購與現場維修後，我們要進入一個對「即時性」與「精準度」要求極高的領域：**遠距醫療與分診 (Healthcare and Telehealth/Triage)**。在 ADK 雙向串流 (Bidi-streaming) 的背景下，這項技術不僅是視訊通話的升級，更是將 AI 轉化為能「看、聽、感知」的數位護理師。

---

### 📌 醫療分診：雙向串流應用學習地圖

1.  **分診新前線**：AI 作為患者接收與基礎諮詢的第一個接觸點。
2.  **多模態感知診斷**：利用視覺影格分析皮疹或身體狀況。
3.  **情感適應互動**：在焦慮情境下發揮同理心。
4.  **技術實踐與規格**：針對醫療影像的 1 FPS 與 768px 規格建議。

---

### 一、 核心概念：AI 作為醫療分診的第一接觸點

在更大的 ADK 串流架構中，遠距醫療不再是僵化的問卷調查，而是**即時雙向通訊**。這代表什麼？患者可以一邊描述症狀，AI 一邊根據語音語調判斷緊急程度，並同步要求查看患部影像。

#### 邏輯具象化：傳統遠距醫療 vs. ADK 雙向串流分診

| 維度         | 傳統遠距醫療 (Legacy)    | ADK 雙向串流分診                |
| :----------- | :----------------------- | :------------------------------ |
| **互動模式** | 單向填表或非即時視訊     | 即時雙向對話，支援中斷與澄清    |
| **視覺介入** | 靜態照片上傳             | **每秒一影格** 的持續影像分析   |
| **情緒評估** | 無或由醫師主觀判斷       | 內建 **情感對話** 偵測情緒訊號  |
| **診斷效率** | 先收集資料，後由醫師分析 | **AI 預分診**，即時詢問澄清問題 |

---

### 二、 場景驅動教學：重塑患者體驗

透過以下三個實際開發場景，我們來解析如何運用 ADK 功能解決醫療痛點。

#### 💡 場景 1：皮膚科初步分診（視覺感知）
**提問：** 「患者發現手臂出現不明皮疹，焦急地尋求建議，AI 該如何引導？」
**解析：**
**關鍵在於視覺感知的即時性。** 代理程式不必等待患者描述完畢。
*   **技術行動**：AI 可以主動說：「我聽到了您的擔心，請將手機攝像頭對準患部，讓我看看。」
*   **多模態融合**：當患者直播患部時，AI 能辨識皮疹特徵並提出後續問題，例如：「這會癢嗎？是從什麼時候開始的？」

#### 💡 場景 2：情緒安撫與壓力監測（情感對話）
**提問：** 「患者在描述症狀時語氣顫抖、明顯焦慮，AI 該如何調整回應？」
**解析：**
這就是 **情感對話 (Affective Dialogue)** 的價值。
*   **這代表什麼？** 原生音訊模型能理解語氣和情感背景。
*   **行為調整**：AI 會偵測到沮喪或焦慮訊號，自動調整為溫和、具同理心的語調，這能顯著提升患者在緊急情況下的信任感。

#### 💡 場景 3：長時健康管理（會話恢復與壓縮）
**提問：** 「如果是長達半小時的心理諮詢或慢性病管理，如何確保對話不因網路波動中斷？」
**解析：**
必須在 `RunConfig` 中啟用 **會話恢復 (Session Resumption)** 與 **上下文視窗壓縮**。
*   **技術保障**：即使網路閃斷，ADK 會自動重新連線並保留完整對話歷史，讓患者不需重新描述病情。

---

### 三、 代碼即真理：醫療分診的關鍵實作

在醫療場景中，處理「即時影像」與「同理心語音」是核心。

#### 1. 配置同理心代理程式 (RunConfig)
**導師點評**：醫療應用建議使用 **原生音訊模型**，以獲取最強的情感適應能力。

```python
# [導師點評]：在 Phase 2 啟用情感對話，這是建立醫療信任的關鍵
run_config = RunConfig(
    streaming_mode=StreamingMode.BIDI,
    response_modalities=["AUDIO"], # 提供類人語音回應
    enable_affective_dialog=True,  # 開啟情緒感知功能
    input_audio_transcription=types.AudioTranscriptionConfig(), # 自動記錄逐字稿
    session_resumption=types.SessionResumptionConfig(), # 確保連線穩定性
)
```

#### 2. 上游任務：處理醫療影像串流
**導師點評**：傳送患部影像時，建議解析度為 768x768，這足以捕捉皮疹細節。

```python
# [導師點評]：這是 Phase 3 的上游動脈。使用 send_realtime 傳遞影格
elif json_message.get("type") == "image":
    # 解碼來自患者端的 base64 影像
    image_data = base64.b64decode(json_message["data"])
    # [關鍵在此]：將影格作為 Blob 以即時模式發送給模型進行分析
    image_blob = types.Blob(
        mime_type="image/jpeg", data=image_data
    )
    live_request_queue.send_realtime(image_blob) #
```

---

### 四、 知識延伸與收斂

在醫療分診應用中，ADK 不僅提供了感官，還提供了**安全性與合規性**的基礎。

*   **自動化轉錄與記錄**：ADK 內建的音訊逐字稿功能，能無縫產生對話日誌，這對於醫療記錄與日後醫師回顧至關重要。
*   **效能優化**：醫療影像傳輸建議維持在 **1 FPS**，解析度 **768x768**，這在頻寬佔用與診斷精準度之間取得了最佳平衡。
*   **隱私與持久化**：如果需要保存視訊診斷過程以供醫療稽核，請務必啟用 `save_live_blob=True`。

**導師實戰總結：**
遠距醫療分診是雙向串流技術最具人道價值的場景之一。開發者應優先考慮 **原生音訊模型** 以獲得情感共鳴，並結合 **1 FPS 的視覺串流** 來輔助臨床判斷。透過 ADK 的封裝，您可以將原本需要數月開發的基礎連線與事件處理工作，簡化為高效的醫療商業邏輯。

🏷️ `telehealth`, `medical-triage`, `bidi-streaming`, `affective-dialogue`, `visual-perception`

---

[← 上一頁](./06-02-customer-service.md) | [下一頁 →](./06-04-finance.md) | [課程首頁 ↩](../COURSE_PLAN.md)