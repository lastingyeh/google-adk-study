<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Google ADK 代理市集</title>
    <!-- 引入 Tailwind CSS -->
    <link href="../tailwind.v2.2.19.min.css" rel="stylesheet" />
    <!-- 引入 Inter 字體 -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Google ADK Tech Theme Variables */
      :root {
        --bg-primary: #0b0f19;
        --bg-secondary: #131620;
        --bg-card: rgba(22, 27, 34, 0.7);
        --bg-card-hover: rgba(30, 36, 46, 0.8);
        --text-primary: #e8eaed;
        --text-secondary: #9aa0a6;
        --accent-blue: #4285f4;
        --accent-purple: #a142f4;
        --google-red: #ea4335;
        --google-yellow: #fbbc04;
        --google-green: #34a853;
        --google-blue: #4285f4;
        --border-color: rgba(255, 255, 255, 0.1);
        --glass-border: 1px solid rgba(255, 255, 255, 0.08);
      }

      /* Base Styles */
      body {
        font-family: 'Inter', 'Noto Sans TC', sans-serif;
        background-color: var(--bg-primary);
        color: var(--text-primary);
        background-image: radial-gradient(
            circle at 15% 50%,
            rgba(66, 133, 244, 0.08) 0%,
            transparent 25%
          ),
          radial-gradient(
            circle at 85% 30%,
            rgba(161, 66, 244, 0.08) 0%,
            transparent 25%
          );
        min-height: 100vh;
      }

      /* Scrollbar */
      ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }
      ::-webkit-scrollbar-track {
        background: var(--bg-primary);
      }
      ::-webkit-scrollbar-thumb {
        background: #3c4043;
        border-radius: 5px;
        border: 2px solid var(--bg-primary);
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #5f6368;
      }

      /* Modal */
      .modal {
        display: none;
        transition: opacity 0.2s ease-in-out;
        backdrop-filter: blur(8px);
      }
      .modal.flex {
        display: flex;
        animation: fadeIn 0.2s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      /* Enhanced Card Styling */
      .agent-card {
        background: var(--bg-card) !important;
        border: var(--glass-border);
        backdrop-filter: blur(12px);
        box-shadow: 0 4px 24px -1px rgba(0, 0, 0, 0.2);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }

      /* Top gradient line for cards */
      .agent-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background: linear-gradient(
          90deg,
          var(--google-blue),
          var(--accent-purple)
        );
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .agent-card:hover {
        transform: translateY(-4px);
        background: var(--bg-card-hover) !important;
        box-shadow: 0 12px 32px -4px rgba(0, 0, 0, 0.3);
        border-color: rgba(66, 133, 244, 0.3);
      }

      .agent-card:hover::before {
        opacity: 1;
      }

      /* Tags */
      .tag {
        font-size: 0.75rem;
        padding: 0.25rem 0.5rem;
        border-radius: 9999px;
        font-weight: 500;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .tag-type {
        background-color: rgba(66, 133, 244, 0.1);
        color: #8ab4f8;
        border-color: rgba(66, 133, 244, 0.2);
      }

      .tag-model {
        background-color: rgba(161, 66, 244, 0.1);
        color: #d7aefb;
        border-color: rgba(161, 66, 244, 0.2);
      }

      /* List View Override */
      .dashboard-grid.list-view {
        grid-template-columns: 1fr !important;
        gap: 0.5rem;
      }

      .dashboard-grid.list-view .agent-card {
        flex-direction: row;
        align-items: center;
        padding: 1rem 1.5rem;
        background: rgba(19, 22, 32, 0.8) !important;
        min-height: auto;
      }

      .dashboard-grid.list-view .agent-card:hover {
        transform: translateX(4px);
      }

      .dashboard-grid.list-view .agent-content {
        display: flex;
        flex-direction: row;
        align-items: center;
        flex: 1;
        width: 100%;
      }

      .dashboard-grid.list-view .agent-header {
        margin-bottom: 0 !important;
        margin-right: 1.5rem;
        min-width: 200px;
      }

      .dashboard-grid.list-view .agent-title {
        font-size: 1rem;
        margin-bottom: 0;
      }

      .dashboard-grid.list-view .agent-description {
        display: block;
        flex: 1;
        margin: 0 1rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 400px;
      }

      .dashboard-grid.list-view .agent-meta {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .dashboard-grid.list-view .agent-footer {
        display: none;
      }

      /* Utilities */
      .text-gradient-gemini {
        background: linear-gradient(to right, #4285f4, #9b72cb, #d96570);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* Fix Search Input Visibility */
      #search-input {
        color: #ffffff !important;
        background-color: #131620 !important;
      }
      #search-input::placeholder {
        color: #9ca3af !important; /* gray-400 */
      }
    </style>
  </head>
  <body>
    <!-- 主容器 -->
    <div class="container mx-auto p-4 md:p-8">
      <!-- 標題 -->
      <header class="text-center mb-10 md:mb-16 relative">
        <!-- Glow Effect -->
        <div
          class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-32 h-32 bg-purple-500/20 rounded-full blur-3xl pointer-events-none"
        ></div>

        <div
          class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-purple-500/10 border border-purple-500/20 text-purple-400 text-xs font-medium mb-4"
        >
          <span class="relative flex h-2 w-2">
            <span
              class="animate-ping absolute inline-flex h-full w-full rounded-full bg-purple-400 opacity-75"
            ></span>
            <span
              class="relative inline-flex rounded-full h-2 w-2 bg-purple-500"
            ></span>
          </span>
          Agents Marketplace
        </div>

        <h1
          class="text-4xl md:text-6xl font-bold text-white mb-4 tracking-tight"
        >
          <span class="text-gradient-gemini">Google ADK</span>
          <br class="md:hidden" />
          <span class="text-gray-100">代理市集</span>
        </h1>
        <p class="text-lg text-gray-400 mt-4 max-w-2xl mx-auto leading-relaxed">
          探索並使用由社群與 Google ADK 團隊打造的智慧代理<br />
          <span class="text-sm text-gray-500"
            >一站式管理、部署與整合您的 AI 助手</span
          >
        </p>

        <div class="mt-8 flex justify-center gap-4">
          <a
            href="../index.html"
            class="px-5 py-2 rounded-full border border-gray-600 bg-gray-800/70 text-sm font-medium text-gray-300 hover:text-white hover:border-blue-500 transition-all"
          >
            ← 返回學習儀表板
          </a>
        </div>
      </header>

      <!-- 搜尋與控制項 -->
      <div
        class="mb-8 flex flex-col sm:flex-row items-center gap-4 sticky top-4 z-30 bg-[#0b0f19]/80 backdrop-blur-md p-2 rounded-xl border border-gray-800/50"
      >
        <!-- Google 風格搜尋框 -->
        <div class="relative w-full sm:flex-grow">
          <div
            class="absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none"
          >
            <svg
              class="w-4 h-4 text-gray-400"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 20 20"
            >
              <path
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"
              />
            </svg>
          </div>
          <input
            type="text"
            id="search-input"
            placeholder="搜尋代理名稱、功能或工具..."
            class="block w-full p-3 pl-12 text-sm text-white border border-gray-700 rounded-lg bg-[#131620] focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500 placeholder-gray-500 transition-all shadow-lg"
          />
          <button
            id="reset-button"
            class="absolute inset-y-0 right-0 flex items-center pr-4 text-gray-400 hover:text-white"
          >
            <svg
              class="w-4 h-4"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 14 14"
            >
              <path
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
              />
            </svg>
            <span class="sr-only">清除搜尋</span>
          </button>
        </div>

        <!-- 視圖切換按鈕 -->
        <div
          class="flex items-center gap-1 bg-[#131620] rounded-lg p-1 border border-gray-700/50"
        >
          <button
            id="card-view-btn"
            class="p-2 rounded-md text-purple-400 bg-purple-500/10 hover:bg-purple-500/20 transition-all duration-200"
            aria-label="卡片模式"
            title="卡片模式"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"
              ></path>
            </svg>
          </button>
          <button
            id="list-view-btn"
            class="p-2 rounded-md text-gray-500 hover:text-gray-300 hover:bg-gray-800/50 transition-all duration-200"
            aria-label="列表模式"
            title="列表模式"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
      </div>

      <!-- 統計資訊 -->
      <div class="mb-6 flex gap-4 text-sm text-gray-400 px-2">
        <span
          >總計：<strong id="total-count" class="text-white">0</strong>
          個代理</span
        >
      </div>

      <!-- 代理卡片容器 -->
      <div
        id="agents-grid"
        class="dashboard-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
      >
        <!-- JavaScript 將在此處動態插入卡片 -->
      </div>
    </div>

    <!-- 彈出式 Modal (預設隱藏) -->
    <div
      id="detail-modal"
      class="modal fixed inset-0 z-50 items-center justify-center overflow-hidden bg-black/80 p-4 backdrop-blur-sm"
    >
      <div
        class="relative w-full max-w-3xl mx-auto bg-[#131620] rounded-2xl shadow-2xl overflow-hidden border border-gray-700/50 transform transition-all"
      >
        <!-- Decorative gradient top -->
        <div
          class="h-1 w-full bg-gradient-to-r from-purple-500 via-blue-500 to-green-500"
        ></div>

        <!-- Modal 頂部 -->
        <div
          class="flex items-center justify-between p-6 border-b border-gray-800/50 bg-[#1a1f2e]"
        >
          <div class="flex flex-col">
            <h2
              id="modal-title"
              class="text-2xl font-bold text-white tracking-tight"
            >
              <!-- Modal 標題將動態填入 -->
            </h2>
            <span
              id="modal-path"
              class="text-xs text-gray-500 font-mono mt-1 break-all"
            ></span>
          </div>

          <!-- 關閉按鈕 -->
          <button
            onclick="closeModal()"
            class="text-gray-400 bg-transparent hover:bg-gray-700 hover:text-white rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center ml-4 flex-shrink-0"
          >
            <svg
              class="w-3 h-3"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 14 14"
            >
              <path
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
              />
            </svg>
            <span class="sr-only">關閉視窗</span>
          </button>
        </div>

        <!-- Modal 內容 (可滾動) -->
        <div id="modal-body" class="p-6 space-y-8 max-h-[70vh] overflow-y-auto">
          <!-- 標籤區 -->
          <div class="flex flex-wrap gap-2" id="modal-tags">
            <!-- 動態標籤 -->
          </div>

          <!-- 詳細說明 -->
          <div>
            <h3
              class="text-lg font-semibold text-blue-400 mb-2 flex items-center gap-2"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                ></path>
              </svg>
              功能描述
            </h3>
            <p
              id="modal-description"
              class="text-base leading-relaxed text-gray-300 bg-gray-800/30 p-4 rounded-lg border border-gray-700/30"
            >
              <!-- Modal 詳細說明將動態填入 -->
            </p>
          </div>

          <!-- 工具列表 -->
          <div id="modal-tools-container" style="display: none">
            <h3
              class="text-lg font-semibold text-green-400 mb-2 flex items-center gap-2"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
                ></path>
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                ></path>
              </svg>
              可用工具 (Tools)
            </h3>
            <div
              class="grid grid-cols-1 sm:grid-cols-2 gap-3"
              id="modal-tools-list"
            >
              <!-- 工具將動態填入 -->
            </div>
          </div>

          <!-- 子代理列表 -->
          <div id="modal-subagents-container" style="display: none">
            <h3
              class="text-lg font-semibold text-purple-400 mb-2 flex items-center gap-2"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
                ></path>
              </svg>
              子代理 (Sub-agents)
            </h3>
            <div class="space-y-2" id="modal-subagents-list">
              <!-- 子代理將動態填入 -->
            </div>
          </div>

          <!-- 其他資訊 (Plugins, Capabilities) -->
          <div id="modal-extras-container" style="display: none">
            <h3
              class="text-lg font-semibold text-yellow-400 mb-2 flex items-center gap-2"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 10V3L4 14h7v7l9-11h-7z"
                ></path>
              </svg>
              其他功能
            </h3>
            <ul
              id="modal-extras-list"
              class="list-disc list-inside space-y-1 text-gray-300"
            ></ul>
          </div>
        </div>
      </div>
    </div>

    <!-- JavaScript 邏輯 -->
    <script>
      // 代理資料
      const agentsData = [
        {
          name: 'hello_assistant',
          path: 'workspace/python/agents/hello-agent',
          type: 'Agent',
          description: 'A friendly AI assistant for general conversation',
          model: 'gemini-2.0-flash',
          tools: [],
        },
        {
          name: 'finance_assistant',
          path: 'workspace/python/agents/finance-assistant',
          type: 'Agent',
          description: 'A financial calculation assistant',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'calculate_compound_interest',
              description:
                'Calculate compound interest for savings or investments',
            },
            {
              name: 'calculate_loan_payment',
              description: 'Calculate monthly loan payments',
            },
            {
              name: 'calculate_monthly_savings',
              description: 'Calculate required monthly savings to reach a goal',
            },
          ],
        },
        {
          name: 'BlogCreationPipeline',
          path: 'workspace/python/agents/blog-pipeline',
          type: 'SequentialAgent',
          description:
            'Complete blog post creation pipeline from research to publishing',
          sub_agents: [
            {
              name: 'researcher',
              description: 'Researches topic and gathers key facts',
            },
            {
              name: 'writer',
              description: 'Writes blog post draft based on research',
            },
            {
              name: 'editor',
              description: 'Reviews blog post draft and provides feedback',
            },
            {
              name: 'formatter',
              description: 'Applies editorial feedback and formats final post',
            },
          ],
        },
        {
          name: 'chuck_norris_agent',
          path: 'workspace/python/agents/chuck-norris-agent',
          type: 'Agent',
          description: 'Chuck Norris fact assistant using OpenAPI tools',
          model: 'gemini-2.0-flash',
          toolsets: [
            {
              name: 'chuck_norris_toolset',
              type: 'OpenAPIToolset',
            },
          ],
        },
        {
          name: 'FinancialCalculator',
          path: 'workspace/python/agents/code-calculator',
          type: 'Agent',
          description: 'Expert financial calculator with Python code execution',
          model: 'gemini-2.0-flash',
          capabilities: ['BuiltInCodeExecutor'],
        },
        {
          name: 'content_moderator',
          path: 'workspace/python/agents/content-moderator',
          type: 'Agent',
          description: 'Content moderation assistant with safety guardrails',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'generate_text',
              description: 'Generates text based on a topic and word count',
            },
            {
              name: 'check_grammar',
              description: 'Checks the grammar of the provided text',
            },
            {
              name: 'get_usage_stats',
              description: 'Returns usage statistics for the tool context',
            },
          ],
          callbacks: [
            'before_agent_callback',
            'after_agent_callback',
            'before_model_callback',
            'after_model_callback',
            'before_tool_callback',
            'after_tool_callback',
          ],
        },
        {
          name: 'ContentPublishingSystem',
          path: 'workspace/python/agents/content-publisher',
          type: 'SequentialAgent',
          description:
            'Complete content publishing system with parallel research and sequential creation',
          sub_agents: [
            {
              name: 'ParallelResearch',
              type: 'ParallelAgent',
              sub_agents: [
                {
                  name: 'NewsPipeline',
                  type: 'SequentialAgent',
                  sub_agents: ['news_fetcher', 'news_summarizer'],
                },
                {
                  name: 'SocialPipeline',
                  type: 'SequentialAgent',
                  sub_agents: ['social_monitor', 'sentiment_analyzer'],
                },
                {
                  name: 'ExpertPipeline',
                  type: 'SequentialAgent',
                  sub_agents: ['expert_finder', 'quote_extractor'],
                },
              ],
            },
            {
              name: 'article_writer',
            },
            {
              name: 'article_editor',
            },
            {
              name: 'article_formatter',
            },
          ],
        },
        {
          name: 'customer_support',
          path: 'workspace/python/agents/customer-support',
          type: 'Agent',
          description:
            'Customer support agent with various tools (Loaded from YAML)',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'check_customer_status',
              description: 'Checks the current status of a customer',
            },
            {
              name: 'log_interaction',
              description: 'Logs a new interaction with a customer',
            },
            {
              name: 'get_order_status',
              description: 'Retrieves the status of a specific order',
            },
            {
              name: 'track_shipment',
              description: 'Tracks the shipment of an order',
            },
            {
              name: 'cancel_order',
              description: 'Cancels an existing order',
            },
            {
              name: 'search_knowledge_base',
              description: 'Searches the knowledge base for answers',
            },
            {
              name: 'run_diagnostic',
              description: 'Runs diagnostic tests for troubleshooting',
            },
            {
              name: 'create_ticket',
              description: 'Creates a new support ticket',
            },
            {
              name: 'get_billing_history',
              description: 'Retrieves the billing history of a customer',
            },
            {
              name: 'process_refund',
              description: 'Processes a refund for an order',
            },
            {
              name: 'update_payment_method',
              description: "Updates the customer's payment method",
            },
          ],
        },
        {
          name: 'lead_qualifier',
          path: 'workspace/python/agents/enterprise-agent',
          type: 'Agent',
          description: 'Enterprise sales lead qualification agent',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'check_company_size',
              description: 'Checks the size of a company',
            },
            {
              name: 'score_lead',
              description: 'Scores a sales lead based on criteria',
            },
            {
              name: 'get_competitive_intel',
              description: 'Gathers competitive intelligence',
            },
          ],
        },
        {
          name: 'EssayRefinementSystem',
          path: 'workspace/python/agents/essay-refiner',
          type: 'SequentialAgent',
          description: 'Complete essay writing and refinement system',
          sub_agents: [
            {
              name: 'InitialWriter',
            },
            {
              name: 'RefinementLoop',
              type: 'LoopAgent',
              sub_agents: [
                {
                  name: 'Critic',
                },
                {
                  name: 'Refiner',
                  tools: ['exit_loop'],
                },
              ],
            },
          ],
        },
        {
          name: 'advanced_grounding_agent',
          path: 'workspace/python/agents/grounding-agent',
          type: 'Agent',
          description:
            'Advanced grounding agent with search, analysis and conditional map tools',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'google_search',
              description: 'Performs a Google search',
            },
            {
              name: 'google_maps_grounding (Conditional)',
              description: 'Provides grounding using Google Maps data',
            },
            {
              name: 'analyze_search_results',
              description: 'Analyzes the results from a search',
            },
            {
              name: 'save_research_findings',
              description: 'Saves the findings from research',
            },
          ],
        },
        {
          name: 'mcp_file_assistant',
          path: 'workspace/python/agents/mcp-agent',
          type: 'Agent',
          description: 'AI assistant with filesystem access via MCP',
          model: 'gemini-2.0-flash-exp',
          tools: [
            {
              name: 'McpToolset (filesystem)',
              description: 'Provides access to filesystem operations via MCP',
            },
          ],
        },
        {
          name: 'model_selector_agent',
          path: 'workspace/python/agents/model-selector',
          type: 'Agent',
          description: 'Expert agent for selecting and comparing AI models',
          model: 'gemini-2.5-flash',
          tools: [
            {
              name: 'recommend_model_for_use_case',
              description: 'Recommends an AI model for a specific use case',
            },
            {
              name: 'get_model_info',
              description: 'Retrieves information about a specific AI model',
            },
          ],
        },
        {
          name: 'multi_llm_agent',
          path: 'workspace/python/agents/multi-llm-agent',
          type: 'Agent',
          description:
            'Multi-LLM agent via LiteLLM supporting OpenAI, Claude, etc.',
          model: 'LiteLlm(openai/gpt-4o-mini)',
          tools: [
            {
              name: 'calculate_square',
              description: 'Calculates the square of a number',
            },
            {
              name: 'get_weather',
              description: 'Gets the weather for a specific city',
            },
            {
              name: 'analyze_sentiment',
              description: 'Analyzes the sentiment of a text',
            },
          ],
        },
        {
          name: 'customer_service',
          path: 'workspace/python/agents/observability-agent',
          type: 'Agent',
          description: 'Customer service agent with event tracking',
          model: 'gemini-2.0-flash-exp',
          tools: [
            {
              name: 'check_order_status',
              description: 'Checks the status of a specific order',
            },
            {
              name: 'process_refund',
              description: 'Processes a refund for an order',
            },
            {
              name: 'check_inventory',
              description: 'Checks inventory availability for a product',
            },
          ],
        },
        {
          name: 'observability_plugins_agent',
          path: 'workspace/python/agents/observability-plugins-agent',
          type: 'Agent',
          description:
            'Production assistant with comprehensive observability plugins',
          model: 'gemini-2.5-flash',
          plugins: [
            'MetricsCollectorPlugin',
            'AlertingPlugin',
            'PerformanceProfilerPlugin',
          ],
        },
        {
          name: 'personal_tutor',
          path: 'workspace/python/agents/personal-tutor',
          type: 'Agent',
          description: 'Personal tutor tracking user progress and preferences',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'set_user_preferences',
              description: "Sets the user's learning preferences",
            },
            {
              name: 'record_topic_completion',
              description: 'Records the completion of a learning topic',
            },
            {
              name: 'get_user_progress',
              description: "Retrieves the user's current progress",
            },
            {
              name: 'start_learning_session',
              description: 'Starts a new learning session',
            },
            {
              name: 'calculate_quiz_grade',
              description: 'Calculates the grade for a quiz',
            },
            {
              name: 'search_past_lessons',
              description: 'Searches through past lessons',
            },
          ],
        },
        {
          name: 'production_deployment_agent',
          path: 'workspace/python/agents/production-agent',
          type: 'Agent',
          description: 'Expert on production deployment strategies',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'check_deployment_status',
              description: 'Checks the status of a deployment',
            },
            {
              name: 'get_deployment_options',
              description: 'Gets available deployment options',
            },
            {
              name: 'get_best_practices',
              description: 'Retrieves deployment best practices',
            },
          ],
        },
        {
          name: 'software_bug_assistant',
          path: 'workspace/python/agents/software-bug-assistant',
          type: 'Agent',
          description: 'Software bug assistant',
          model: 'gemini-2.5-flash',
          tools: [
            {
              name: 'get_current_date',
              description: 'Gets the current date',
            },
            {
              name: 'search_tool (AgentTool)',
              description: 'Search tool wrapper for agent',
            },
            {
              name: 'langchain_tool (StackExchange)',
              description: 'StackExchange search tool via LangChain',
            },
            {
              name: 'toolbox_tools (Google Cloud Toolbox)',
              description: 'Google Cloud Toolbox utilities',
            },
            {
              name: 'mcp_tools (GitHub MCP)',
              description: 'GitHub MCP tools for code interaction',
            },
          ],
        },
        {
          name: 'plan_react_strategic_solver',
          path: 'workspace/python/agents/strategic-solver',
          type: 'Agent',
          description: 'Strategic business consultant using PlanReActPlanner',
          model: 'gemini-2.0-flash',
          planner: 'PlanReActPlanner',
          tools: [
            {
              name: 'analyze_market',
              description: 'Analyzes market trends and data',
            },
            {
              name: 'calculate_roi',
              description: 'Calculates Return on Investment (ROI)',
            },
            {
              name: 'assess_risk',
              description: 'Assesses potential business risks',
            },
            {
              name: 'save_strategy_report',
              description: 'Saves the generated strategy report',
            },
          ],
        },
        {
          name: 'streaming_assistant',
          path: 'workspace/python/agents/streaming-agent',
          type: 'Agent',
          description:
            'Helpful assistant providing real-time streaming responses',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'format_streaming_info',
              description: 'Formats info for streaming response',
            },
            {
              name: 'analyze_streaming_performance',
              description: 'Analyzes streaming performance metrics',
            },
          ],
        },
        {
          name: 'support_agent',
          path: 'workspace/python/agents/support-agent',
          type: 'Agent',
          description:
            'Customer support agent with KB search and ticket creation',
          model: 'gemini-2.0-flash-exp',
          tools: [
            {
              name: 'search_knowledge_base',
              description: 'Searches the knowledge base for solutions',
            },
            {
              name: 'create_ticket',
              description: 'Creates a new support ticket',
            },
            {
              name: 'check_ticket_status',
              description: 'Checks the status of an existing ticket',
            },
          ],
        },
        {
          name: 'third_party_agent',
          path: 'workspace/python/agents/third-party-agent',
          type: 'Agent',
          description:
            'Agent integrating third-party tools (LangChain, CrewAI)',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'create_wikipedia_tool',
              description: 'Creates a tool for Wikipedia searches',
            },
            {
              name: 'create_web_search_tool',
              description: 'Creates a tool for general web searches',
            },
            {
              name: 'create_directory_read_tool',
              description: 'Creates a tool for reading directory contents',
            },
            {
              name: 'create_file_read_tool',
              description: 'Creates a tool for reading file contents',
            },
          ],
        },
        {
          name: 'a2a_orchestrator',
          path: 'workspace/python/agents/a2a-orchestrator',
          type: 'Agent',
          description:
            'Orchestrator agent using ADK A2A to coordinate remote agents',
          model: 'gemini-2.0-flash',
          sub_agents: [
            {
              name: 'research_specialist',
              type: 'RemoteA2aAgent',
            },
            {
              name: 'data_analyst',
              type: 'RemoteA2aAgent',
            },
            {
              name: 'content_writer',
              type: 'RemoteA2aAgent',
            },
          ],
          tools: [
            {
              name: 'check_agent_availability',
              description: 'Checks if a specific agent is available',
            },
            {
              name: 'log_coordination_step',
              description: 'Logs a step in the coordination process',
            },
          ],
        },
        {
          name: 'artifact_agent',
          path: 'workspace/python/agents/artifact-agent',
          type: 'Agent',
          description:
            'Document processing agent with artifact storage and versioning',
          model: 'gemini-1.5-flash',
          tools: [
            {
              name: 'extract_text_tool',
              description: 'Extracts text from a document',
            },
            {
              name: 'summarize_document_tool',
              description: 'Summarizes the content of a document',
            },
            {
              name: 'translate_document_tool',
              description: 'Translates a document to another language',
            },
            {
              name: 'create_final_report_tool',
              description: 'Creates a final report from processed data',
            },
            {
              name: 'list_artifacts_tool',
              description: 'Lists all available artifacts',
            },
            {
              name: 'load_artifact_tool',
              description: 'Loads a specific artifact',
            },
            {
              name: 'load_artifacts_tool',
              description: 'Loads multiple artifacts',
            },
          ],
        },
        {
          name: 'best_practices_agent',
          path: 'workspace/python/agents/best-practices-agent',
          type: 'Agent',
          description: 'Production-ready agent demonstrating best practices',
          model: 'gemini-2.5-flash',
          tools: [
            {
              name: 'validate_input_tool',
              description: 'Validates input data against schema',
            },
            {
              name: 'retry_with_backoff_tool',
              description: 'Retries an operation with exponential backoff',
            },
            {
              name: 'circuit_breaker_call_tool',
              description: 'Executes a call wrapped in a circuit breaker',
            },
            {
              name: 'cache_operation_tool',
              description: 'Performs a cached operation',
            },
            {
              name: 'batch_process_tool',
              description: 'Processes items in a batch',
            },
            {
              name: 'health_check_tool',
              description: 'Checks the health of the system',
            },
            {
              name: 'get_metrics_tool',
              description: 'Retrieves system metrics',
            },
          ],
        },
        {
          name: 'TravelPlanningSystem',
          path: 'workspace/python/agents/travel-planner',
          type: 'SequentialAgent',
          description: 'Complete travel planning system with parallel search',
          sub_agents: [
            {
              name: 'ParallelSearch',
              type: 'ParallelAgent',
              sub_agents: [
                {
                  name: 'flight_finder',
                },
                {
                  name: 'hotel_finder',
                },
                {
                  name: 'activity_finder',
                },
              ],
            },
            {
              name: 'itinerary_builder',
            },
          ],
        },
        {
          name: 'vision_catalog_coordinator',
          path: 'workspace/python/agents/vision-catalog-agent',
          type: 'Agent',
          description: 'Multimodal visual product catalog coordinator',
          model: 'gemini-2.0-flash-exp',
          tools: [
            {
              name: 'list_sample_images',
              description: 'Lists sample images available for processing',
            },
            {
              name: 'generate_product_mockup',
              description: 'Generates a visual mockup of a product',
            },
            {
              name: 'analyze_uploaded_image',
              description: 'Analyzes an image uploaded by the user',
            },
            {
              name: 'analyze_product_image',
              description: 'Analyzes a product image for details',
            },
            {
              name: 'compare_product_images',
              description: 'Compares two product images',
            },
          ],
        },
        {
          name: 'voice_assistant',
          path: 'workspace/python/agents/voice-assistant',
          type: 'Agent',
          description: 'Real-time voice assistant supporting Live API',
          model: 'gemini-2.0-flash-live-001',
          capabilities: ['Audio Recording/Playback', 'Live API Streaming'],
        },
        {
          name: 'youtube_shorts_agent',
          path: 'workspace/python/agents/youtube-shorts-assistant',
          type: 'LlmAgent',
          description: 'Agent for creating YouTube Short videos',
          model: 'gemini-2.0-flash-001',
          tools: [
            {
              name: 'scriptwriter_agent (AgentTool)',
              description: 'Agent responsible for writing video scripts',
            },
            {
              name: 'visualizer_agent (AgentTool)',
              description: 'Agent responsible for creating visual concepts',
            },
            {
              name: 'formatter_agent (AgentTool)',
              description: 'Agent responsible for formatting the final content',
            },
          ],
        },
      ];

      // DOM 元素
      const grid = document.getElementById('agents-grid');
      const searchInput = document.getElementById('search-input');
      const resetButton = document.getElementById('reset-button');
      const totalCountEl = document.getElementById('total-count');
      const modal = document.getElementById('detail-modal');

      // 更新總數
      totalCountEl.textContent = agentsData.length;

      // 建立卡片
      function createCard(agent, index) {
        const card = document.createElement('div');
        card.className =
          'agent-card bg-gray-800 rounded-lg cursor-pointer flex flex-col justify-between';
        card.onclick = () => openModal(index);

        // Header Section (flex row in list view, col in card view)
        const content = document.createElement('div');
        content.className = 'agent-content p-5 flex flex-col h-full';

        // Header
        const header = document.createElement('div');
        header.className = 'agent-header flex justify-between items-start mb-3';

        const title = document.createElement('h3');
        title.className =
          'agent-title text-lg font-bold text-white tracking-tight group-hover:text-purple-300 transition-colors';
        title.textContent = agent.name;

        header.appendChild(title);

        // Label Block
        const labelBlock = document.createElement('div');
        labelBlock.className = 'agent-labels flex flex-wrap gap-2 mb-3';

        // Add type tag if not "Agent"
        if (agent.type && agent.type !== 'Agent') {
          const typeTag = document.createElement('span');
          typeTag.className = 'tag tag-type text-xs';
          typeTag.textContent = agent.type;
          labelBlock.appendChild(typeTag);
        }

        // Description
        const desc = document.createElement('p');
        desc.className =
          'agent-description text-sm text-gray-400 mb-4 line-clamp-2 flex-grow';
        desc.textContent = agent.description;

        // Meta Info (Model & Tools count)
        const meta = document.createElement('div');
        meta.className = 'agent-meta flex items-center gap-3 mt-auto';

        if (agent.model) {
          const modelTag = document.createElement('span');
          modelTag.className = 'tag tag-model flex items-center gap-1';
          modelTag.innerHTML = `
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"></path></svg>
                ${agent.model.split('/')[1] || agent.model}
            `;
          meta.appendChild(modelTag);
        }

        const toolCount =
          (agent.tools ? agent.tools.length : 0) +
          (agent.sub_agents ? agent.sub_agents.length : 0);
        if (toolCount > 0) {
          const toolsTag = document.createElement('span');
          toolsTag.className =
            'text-xs text-gray-500 font-medium flex items-center gap-1';
          toolsTag.innerHTML = `
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                ${toolCount} tools/agents
             `;
          meta.appendChild(toolsTag);
        }

        content.appendChild(header);
        content.appendChild(labelBlock); // Insert Label Block
        content.appendChild(desc);
        content.appendChild(meta);

        // Footer (Card view only)
        const footer = document.createElement('div');
        footer.className =
          'agent-footer px-5 py-3 border-t border-gray-700/50 flex justify-between items-center bg-gray-800/50';
        footer.innerHTML = `
            <span class="text-xs text-gray-500 font-mono truncate max-w-[180px]" title="${
              agent.path
            }">${agent.path.split('/').pop()}</span>
            <span class="text-purple-400 text-xs font-semibold group-hover:translate-x-1 transition-transform">詳情 →</span>
        `;

        card.appendChild(content);
        card.appendChild(footer);

        return card;
      }

      // 渲染所有卡片
      function renderCards(agents) {
        grid.innerHTML = '';
        agents.forEach((agent, index) => {
          // 因為篩選後 index 會變，所以這裡我們傳遞原始資料的 index
          const originalIndex = agentsData.indexOf(agent);
          grid.appendChild(createCard(agent, originalIndex));
        });
      }

      // 初始渲染
      renderCards(agentsData);

      // 搜尋功能
      searchInput.addEventListener('input', (e) => {
        const term = e.target.value.toLowerCase();
        const filtered = agentsData.filter(
          (agent) =>
            agent.name.toLowerCase().includes(term) ||
            agent.description.toLowerCase().includes(term) ||
            (agent.tools &&
              agent.tools.some((t) => t.name.toLowerCase().includes(term)))
        );
        renderCards(filtered);
      });

      resetButton.addEventListener('click', () => {
        searchInput.value = '';
        renderCards(agentsData);
      });

      // Modal 功能
      function openModal(index) {
        const agent = agentsData[index];
        document.getElementById('modal-title').textContent = agent.name;
        document.getElementById('modal-path').textContent = agent.path;
        document.getElementById('modal-description').textContent =
          agent.description;

        // Tags
        const tagsContainer = document.getElementById('modal-tags');
        tagsContainer.innerHTML = '';

        // Type Tag
        const typeSpan = document.createElement('span');
        typeSpan.className = 'tag tag-type';
        typeSpan.textContent = agent.type;
        tagsContainer.appendChild(typeSpan);

        // Model Tag
        if (agent.model) {
          const modelSpan = document.createElement('span');
          modelSpan.className = 'tag tag-model';
          modelSpan.textContent = agent.model;
          tagsContainer.appendChild(modelSpan);
        }

        // Tools
        const toolsContainer = document.getElementById('modal-tools-container');
        const toolsList = document.getElementById('modal-tools-list');
        toolsList.innerHTML = '';

        if (agent.tools && agent.tools.length > 0) {
          toolsContainer.style.display = 'block';
          agent.tools.forEach((tool) => {
            const div = document.createElement('div');
            div.className =
              'bg-gray-800/50 p-3 rounded border border-gray-700/50 hover:border-gray-600 transition-colors';

            let paramsHtml = '';
            if (tool.parameters && tool.parameters.length > 0) {
              paramsHtml =
                '<div class="mt-2 pt-2 border-t border-gray-700/30 space-y-1">';
              tool.parameters.forEach((param) => {
                paramsHtml += `
                            <div class="flex items-baseline text-xs">
                                <span class="text-blue-300 font-mono mr-2">${param.name}</span>
                                <span class="text-gray-500 mr-2">(${param.type})</span>
                                <span class="text-gray-400">${param.description}</span>
                            </div>
                        `;
              });
              paramsHtml += '</div>';
            }

            div.innerHTML = `
                    <div class="font-mono text-sm text-green-300 font-semibold mb-1">${
                      tool.name
                    }</div>
                    ${
                      tool.description
                        ? `<div class="text-xs text-gray-400 mb-1">${tool.description}</div>`
                        : ''
                    }
                    ${paramsHtml}
                `;
            toolsList.appendChild(div);
          });
        } else if (agent.toolsets && agent.toolsets.length > 0) {
          toolsContainer.style.display = 'block';
          agent.toolsets.forEach((ts) => {
            const div = document.createElement('div');
            div.className =
              'bg-gray-800/50 p-3 rounded border border-gray-700/50';
            div.innerHTML = `
                    <div class="font-mono text-sm text-green-300 font-semibold mb-1">${ts.name}</div>
                    <div class="text-xs text-gray-400">Type: ${ts.type}</div>
                `;
            toolsList.appendChild(div);
          });
        } else {
          toolsContainer.style.display = 'none';
        }

        // Sub-agents
        const subAgentsContainer = document.getElementById(
          'modal-subagents-container'
        );
        const subAgentsList = document.getElementById('modal-subagents-list');
        subAgentsList.innerHTML = '';

        if (agent.sub_agents && agent.sub_agents.length > 0) {
          subAgentsContainer.style.display = 'block';

          // Helper to render sub-agents recursively (simplified for UI)
          function renderSubAgent(sub, depth = 0) {
            const div = document.createElement('div');
            div.className = `p-2 rounded bg-gray-800/30 border border-gray-700/30 ${
              depth > 0 ? 'ml-4' : ''
            }`;

            let content = `<div class="flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-purple-500"></span>
                    <span class="font-semibold text-gray-200">${
                      typeof sub === 'string' ? sub : sub.name
                    }</span>
                    ${
                      sub.type
                        ? `<span class="text-xs px-2 py-0.5 rounded bg-purple-900/30 text-purple-300 border border-purple-500/20">${sub.type}</span>`
                        : ''
                    }
                </div>`;

            if (sub.description) {
              content += `<div class="text-sm text-gray-400 mt-1 ml-4">${sub.description}</div>`;
            }

            div.innerHTML = content;
            subAgentsList.appendChild(div);

            if (sub.sub_agents && Array.isArray(sub.sub_agents)) {
              sub.sub_agents.forEach((child) =>
                renderSubAgent(child, depth + 1)
              );
            }
          }

          agent.sub_agents.forEach((sub) => renderSubAgent(sub));
        } else {
          subAgentsContainer.style.display = 'none';
        }

        // Extras (Plugins, Capabilities, Planner)
        const extrasContainer = document.getElementById(
          'modal-extras-container'
        );
        const extrasList = document.getElementById('modal-extras-list');
        extrasList.innerHTML = '';
        let hasExtras = false;

        if (agent.plugins) {
          hasExtras = true;
          agent.plugins.forEach((p) => {
            extrasList.innerHTML += `<li>Plugin: <span class="text-yellow-200">${p}</span></li>`;
          });
        }
        if (agent.capabilities) {
          hasExtras = true;
          agent.capabilities.forEach((c) => {
            extrasList.innerHTML += `<li>Capability: <span class="text-yellow-200">${c}</span></li>`;
          });
        }
        if (agent.planner) {
          hasExtras = true;
          extrasList.innerHTML += `<li>Planner: <span class="text-yellow-200">${agent.planner}</span></li>`;
        }

        extrasContainer.style.display = hasExtras ? 'block' : 'none';

        modal.classList.add('flex');
        document.body.style.overflow = 'hidden';
      }

      function closeModal() {
        modal.classList.remove('flex');
        document.body.style.overflow = 'auto';
      }

      // Close modal on click outside
      modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
      });

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeModal();
      });

      // View Toggle
      const cardViewBtn = document.getElementById('card-view-btn');
      const listViewBtn = document.getElementById('list-view-btn');

      function setView(mode) {
        if (mode === 'list') {
          grid.classList.add('list-view');
          listViewBtn.classList.add('text-purple-400', 'bg-purple-500/10');
          listViewBtn.classList.remove('text-gray-500');
          cardViewBtn.classList.remove('text-purple-400', 'bg-purple-500/10');
          cardViewBtn.classList.add('text-gray-500');
          localStorage.setItem('adkAgentsViewMode', 'list');
        } else {
          grid.classList.remove('list-view');
          cardViewBtn.classList.add('text-purple-400', 'bg-purple-500/10');
          cardViewBtn.classList.remove('text-gray-500');
          listViewBtn.classList.remove('text-purple-400', 'bg-purple-500/10');
          listViewBtn.classList.add('text-gray-500');
          localStorage.setItem('adkAgentsViewMode', 'card');
        }
      }

      cardViewBtn.addEventListener('click', () => setView('card'));
      listViewBtn.addEventListener('click', () => setView('list'));

      // Restore view pref
      if (localStorage.getItem('adkAgentsViewMode') === 'list') {
        setView('list');
      }
    </script>
  </body>
</html>
