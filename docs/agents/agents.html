<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Google ADK 代理市集</title>
    <!-- 引入 Inter 字體 -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* ===== iOS Grouped 風格 CSS ===== */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display',
          'Inter', 'Noto Sans TC', sans-serif;
        background-color: #f2f2f7;
        color: #000000;
        line-height: 1.5;
        padding: 20px 0;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      /* Header */
      header {
        text-align: center;
        margin-bottom: 24px;
        padding: 40px 20px 30px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 20px;
        box-shadow: 0 4px 20px rgba(102, 126, 234, 0.3);
        position: relative;
      }

      header h1 {
        font-size: 32px;
        font-weight: 700;
        color: #ffffff;
        margin-bottom: 8px;
        letter-spacing: -0.5px;
      }

      header p {
        font-size: 15px;
        color: rgba(255, 255, 255, 0.9);
        margin-bottom: 20px;
      }

      /* Stats Bar */
      .stats-bar {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px;
        flex-wrap: wrap;
        margin-top: 20px;
        padding: 16px;
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(10px);
        border-radius: 12px;
      }

      .stat-item {
        display: flex;
        align-items: center;
        gap: 8px;
        color: rgba(255, 255, 255, 0.95);
        font-size: 14px;
        font-weight: 500;
      }

      .stat-icon {
        width: 20px;
        height: 20px;
        fill: rgba(255, 255, 255, 0.9);
      }

      /* Navigation Links */
      .nav-links {
        display: flex;
        justify-content: center;
        gap: 12px;
        flex-wrap: wrap;
        margin-bottom: 20px;
      }

      .nav-link {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 8px 16px;
        background: #ffffff;
        color: #007aff;
        text-decoration: none;
        border-radius: 10px;
        font-size: 13px;
        font-weight: 600;
        transition: all 0.2s ease;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      }

      .nav-link:hover {
        background: #007aff;
        color: #ffffff;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);
      }

      .nav-link svg {
        width: 16px;
        height: 16px;
      }

      /* Search & Controls */
      .controls-bar {
        display: flex;
        gap: 12px;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .search-container {
        flex: 1;
        min-width: 250px;
        position: relative;
      }

      .search-input {
        width: 100%;
        padding: 12px 40px 12px 40px;
        border: 1px solid #e5e5ea;
        border-radius: 12px;
        font-size: 15px;
        background: #ffffff;
        transition: all 0.2s ease;
      }

      .search-input:focus {
        outline: none;
        border-color: #007aff;
        box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
      }

      .search-icon {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        width: 18px;
        height: 18px;
        color: #8e8e93;
      }

      .clear-btn {
        position: absolute;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        cursor: pointer;
        color: #8e8e93;
        font-size: 20px;
        padding: 4px;
        display: none;
      }

      .search-input:not(:placeholder-shown) ~ .clear-btn {
        display: block;
      }

      /* Agent Cards Container */
      #agents-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 16px;
        margin-bottom: 20px;
      }

      /* Agent Card */
      .agent-card {
        background: #ffffff;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
        transition: all 0.3s ease;
        cursor: pointer;
        position: relative;
        display: flex;
        flex-direction: column;
        padding: 16px;
      }

      .agent-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 3px;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      }

      .agent-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(102, 126, 234, 0.2);
      }

      .agent-card:active {
        transform: translateY(-2px);
      }

      /* Card Header */
      .agent-header {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        margin-bottom: 12px;
      }

      .agent-icon {
        flex-shrink: 0;
        width: 48px;
        height: 48px;
        border-radius: 12px;
        overflow: hidden;
        background: #ffffff;
        border: 2px solid #e0e7ff;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .agent-icon img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .agent-title-group {
        flex: 1;
        min-width: 0;
      }

      .agent-title {
        font-size: 17px;
        font-weight: 600;
        color: #000000;
        margin-bottom: 2px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      .agent-path {
        font-size: 12px;
        color: #007aff;
        font-family: 'SF Mono', 'Monaco', monospace;
        text-decoration: none;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        gap: 4px;
        overflow: hidden;
      }

      .agent-path:hover {
        color: #0051d5;
        text-decoration: underline;
      }

      .agent-path svg {
        width: 12px;
        height: 12px;
        flex-shrink: 0;
      }

      .agent-path span {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      /* Card Body */
      .agent-description {
        font-size: 14px;
        color: #3c3c43;
        line-height: 1.6;
        margin-bottom: 12px;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      /* Card Labels */
      .agent-labels {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        margin-bottom: 12px;
      }

      .label-tag {
        display: inline-block;
        padding: 4px 10px;
        background-color: #e5e5ea;
        color: #3c3c43;
        font-size: 11px;
        border-radius: 12px;
        font-weight: 500;
        white-space: nowrap;
      }

      .label-tag.type {
        background: linear-gradient(135deg, #4285f415 0%, #4285f425 100%);
        color: #4285f4;
        border: 1px solid #4285f430;
      }

      .label-tag.model {
        background: linear-gradient(135deg, #a142f415 0%, #a142f425 100%);
        color: #a142f4;
        border: 1px solid #a142f430;
      }

      /* Card Footer */
      .agent-meta {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 12px;
        color: #8e8e93;
        padding-top: 12px;
        border-top: 1px solid #f2f2f7;
        margin-top: auto;
      }

      .meta-item {
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .meta-item svg {
        width: 14px;
        height: 14px;
      }

      /* Modal */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        z-index: 1000;
        align-items: center;
        justify-content: center;
        padding: 20px;
        backdrop-filter: blur(8px);
        animation: fadeIn 0.2s ease;
      }

      .modal.show {
        display: flex;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .modal-content {
        background: #ffffff;
        border-radius: 20px;
        max-width: 700px;
        width: 100%;
        max-height: 85vh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        animation: slideUp 0.3s ease;
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .modal-header {
        padding: 24px 24px 16px;
        border-bottom: 0.5px solid #e5e5ea;
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        flex-shrink: 0;
        background: #ffffff;
      }

      .modal-title-group {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .modal-type-badge {
        display: inline-block;
        padding: 4px 12px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        width: fit-content;
      }

      .modal-title {
        font-size: 20px;
        font-weight: 700;
        color: #000000;
        line-height: 1.4;
        padding-right: 16px;
        margin: 0;
      }

      .modal-path {
        font-size: 11px;
        color: #007aff;
        font-family: 'SF Mono', 'Monaco', monospace;
        text-decoration: none;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        gap: 4px;
      }

      .modal-path:hover {
        color: #0051d5;
        text-decoration: underline;
      }

      .modal-path svg {
        width: 14px;
        height: 14px;
        flex-shrink: 0;
      }

      .close-btn {
        width: 32px;
        height: 32px;
        border: none;
        background: #e5e5ea;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        font-size: 20px;
        color: #3c3c43;
        flex-shrink: 0;
      }

      .close-btn:hover {
        background: #d1d1d6;
      }

      .modal-body {
        padding: 24px;
        overflow-y: auto;
        flex: 1;
        min-height: 0;
        -webkit-overflow-scrolling: touch;
      }

      /* 自定義滾動條樣式 */
      .modal-body::-webkit-scrollbar {
        width: 10px;
      }

      .modal-body::-webkit-scrollbar-track {
        background: #f9f9f9;
        border-radius: 5px;
        margin: 8px 0;
      }

      .modal-body::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
        border-radius: 5px;
        border: 2px solid #f9f9f9;
      }

      .modal-body::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, #764ba2 0%, #667eea 100%);
      }

      .detail-section {
        margin-bottom: 24px;
      }

      .detail-section:last-child {
        margin-bottom: 0;
      }

      .detail-section h3 {
        font-size: 15px;
        font-weight: 700;
        color: #667eea;
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 8px;
        padding-bottom: 8px;
        border-bottom: 2px solid #f2f2f7;
      }

      .detail-section h3 svg {
        width: 18px;
        height: 18px;
      }

      .description-box {
        background: linear-gradient(135deg, #f0f4ff 0%, #f9f9ff 100%);
        padding: 16px;
        border-radius: 12px;
        border: 2px solid #e0e7ff;
        font-size: 15px;
        line-height: 1.7;
        color: #1a1a1a;
      }

      .detail-list {
        display: grid;
        gap: 8px;
      }

      .detail-item {
        background: #f9f9f9;
        padding: 12px 16px;
        border-radius: 10px;
        border: 1px solid #e5e5ea;
        font-size: 14px;
        line-height: 1.6;
      }

      .detail-item strong {
        color: #667eea;
        font-weight: 600;
        display: block;
        margin-bottom: 4px;
      }

      .detail-item p {
        color: #3c3c43;
        margin: 0;
      }

      .modal-labels {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }

      .modal-label-tag {
        padding: 6px 14px;
        background: linear-gradient(135deg, #ffffff 0%, #f9f9f9 100%);
        color: #667eea;
        font-size: 13px;
        border-radius: 16px;
        font-weight: 600;
        border: 2px solid #e0e7ff;
        transition: all 0.2s ease;
        cursor: default;
      }

      .modal-label-tag:hover {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #ffffff;
        border-color: #667eea;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.25);
      }

      /* Empty State */
      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #8e8e93;
      }

      .empty-state svg {
        width: 64px;
        height: 64px;
        margin-bottom: 16px;
        opacity: 0.5;
      }

      .empty-state h3 {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 8px;
        color: #3c3c43;
      }

      .empty-state p {
        font-size: 14px;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        header h1 {
          font-size: 24px;
        }

        .stats-bar {
          flex-direction: column;
          gap: 12px;
        }

        .nav-links {
          flex-direction: column;
        }

        .nav-link {
          width: 100%;
          justify-content: center;
        }

        .controls-bar {
          flex-direction: column;
        }

        .search-container {
          width: 100%;
        }

        #agents-grid {
          grid-template-columns: 1fr;
        }

        .modal-content {
          max-width: 100%;
          max-height: 95vh;
        }

        .modal-body {
          padding: 16px;
        }

        .modal-title {
          font-size: 18px;
        }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <!-- Header -->
      <header>
        <h1>Google ADK 代理市集</h1>
        <p>探索專案實現與整合社群打造的 AI 助手</p>

        <!-- Stats Bar -->
        <div class="stats-bar">
          <div class="stat-item">
            <svg class="stat-icon" fill="currentColor" viewBox="0 0 20 20">
              <path
                d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
              ></path>
            </svg>
            <span>總計：<strong id="total-count">0</strong> 個代理</span>
          </div>
          <div class="stat-item">
            <svg class="stat-icon" fill="currentColor" viewBox="0 0 20 20">
              <path
                fill-rule="evenodd"
                d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z"
                clip-rule="evenodd"
              ></path>
            </svg>
            <span id="agent-types-count">0 種類型</span>
          </div>
        </div>
      </header>

      <!-- Navigation Links -->
      <div class="nav-links">
        <a href="../index.html" class="nav-link">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 19l-7-7m0 0l7-7m-7 7h18"
            ></path>
          </svg>
          返回學習儀表板
        </a>
      </div>

      <!-- Search & View Controls -->
      <div class="controls-bar">
        <div class="search-container">
          <svg
            class="search-icon"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
            ></path>
          </svg>
          <input
            type="text"
            id="search-input"
            class="search-input"
            placeholder="搜尋代理名稱、功能或工具..."
          />
          <button class="clear-btn" id="clear-btn">×</button>
        </div>
      </div>

      <!-- Agent Cards Container -->
      <div id="agents-grid">
        <!-- JavaScript 將在此處動態插入卡片 -->
      </div>
    </div>

    <!-- Detail Modal -->
    <div class="modal" id="detail-modal">
      <div class="modal-content">
        <div class="modal-header">
          <div class="modal-title-group">
            <span class="modal-type-badge" id="modal-type"></span>
            <h2 class="modal-title" id="modal-title"></h2>
            <div id="modal-path"></div>
          </div>
          <button class="close-btn" id="close-btn">×</button>
        </div>
        <div class="modal-body" id="modal-body">
          <!-- 動態內容將在此處填入 -->
        </div>
      </div>
    </div>

    <!-- JavaScript 邏輯 -->
    <script>
      // 代理資料
      const agentsData = [
        {
          name: 'hello_assistant',
          path: 'workspace/python/agents/hello-agent',
          type: 'Agent',
          description: '一個用於一般對話的友善 AI 助理',
          model: 'gemini-2.0-flash',
          tools: [],
        },
        {
          name: 'finance_assistant',
          path: 'workspace/python/agents/finance-assistant',
          type: 'Agent',
          description: '一個財務計算助理',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'calculate_compound_interest',
              description: '計算儲蓄或投資的複利',
            },
            {
              name: 'calculate_loan_payment',
              description: '計算每月貸款還款金額',
            },
            {
              name: 'calculate_monthly_savings',
              description: '計算為達成目標所需的每月儲蓄金額',
            },
          ],
        },
        {
          name: 'BlogCreationPipeline',
          path: 'workspace/python/agents/blog-pipeline',
          type: 'SequentialAgent',
          description: '從研究到發布的完整部落格文章創建流程',
          sub_agents: [
            {
              name: 'researcher',
              description: '研究主題並收集關鍵事實',
            },
            {
              name: 'writer',
              description: '根據研究撰寫部落格文章草稿',
            },
            {
              name: 'editor',
              description: '審查部落格文章草稿並提供回饋',
            },
            {
              name: 'formatter',
              description: '應用編輯回饋並格式化最終文章',
            },
          ],
        },
        {
          name: 'chuck_norris_agent',
          path: 'workspace/python/agents/chuck-norris-agent',
          type: 'Agent',
          description: '使用 OpenAPI 工具的 Chuck Norris 笑話助理',
          model: 'gemini-2.0-flash',
          toolsets: [
            {
              name: 'chuck_norris_toolset',
              type: 'OpenAPIToolset',
            },
          ],
        },
        {
          name: 'FinancialCalculator',
          path: 'workspace/python/agents/code-calculator',
          type: 'Agent',
          description: '具備 Python 程式碼執行能力的專業財務計算機',
          model: 'gemini-2.0-flash',
          capabilities: ['BuiltInCodeExecutor'],
        },
        {
          name: 'content_moderator',
          path: 'workspace/python/agents/content-moderator',
          type: 'Agent',
          description: '具備安全護欄的內容審核助理',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'generate_text',
              description: '根據主題和字數生成文本',
            },
            {
              name: 'check_grammar',
              description: '檢查所提供文本的語法',
            },
            {
              name: 'get_usage_stats',
              description: '返回工具上下文的使用統計數據',
            },
          ],
          callbacks: [
            'before_agent_callback',
            'after_agent_callback',
            'before_model_callback',
            'after_model_callback',
            'before_tool_callback',
            'after_tool_callback',
          ],
        },
        {
          name: 'ContentPublishingSystem',
          path: 'workspace/python/agents/content-publisher',
          type: 'SequentialAgent',
          description: '具有平行研究和順序創建功能的完整內容發布系統',
          sub_agents: [
            {
              name: 'ParallelResearch',
              type: 'ParallelAgent',
              sub_agents: [
                {
                  name: 'NewsPipeline',
                  type: 'SequentialAgent',
                  sub_agents: ['news_fetcher', 'news_summarizer'],
                },
                {
                  name: 'SocialPipeline',
                  type: 'SequentialAgent',
                  sub_agents: ['social_monitor', 'sentiment_analyzer'],
                },
                {
                  name: 'ExpertPipeline',
                  type: 'SequentialAgent',
                  sub_agents: ['expert_finder', 'quote_extractor'],
                },
              ],
            },
            {
              name: 'article_writer',
            },
            {
              name: 'article_editor',
            },
            {
              name: 'article_formatter',
            },
          ],
        },
        {
          name: 'customer_support',
          path: 'workspace/python/agents/customer-support',
          type: 'Agent',
          description: '具備多種工具的客戶支援代理 (從 YAML 載入)',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'check_customer_status',
              description: '檢查客戶的當前狀態',
            },
            {
              name: 'log_interaction',
              description: '記錄與客戶的新互動',
            },
            {
              name: 'get_order_status',
              description: '檢索特定訂單的狀態',
            },
            {
              name: 'track_shipment',
              description: '追蹤訂單的貨運狀態',
            },
            {
              name: 'cancel_order',
              description: '取消現有訂單',
            },
            {
              name: 'search_knowledge_base',
              description: '在知識庫中搜尋答案',
            },
            {
              name: 'run_diagnostic',
              description: '運行診斷測試以進行故障排除',
            },
            {
              name: 'create_ticket',
              description: '創建新的支援工單',
            },
            {
              name: 'get_billing_history',
              description: '檢索客戶的帳單歷史記錄',
            },
            {
              name: 'process_refund',
              description: '處理訂單的退款',
            },
            {
              name: 'update_payment_method',
              description: '更新客戶的付款方式',
            },
          ],
        },
        {
          name: 'customer_support_agent',
          path: 'workspace/python/agents/customer-support-agent',
          type: 'Agent',
          description:
            '整合 AG-UI 的客戶支援 ADK 代理人，提供客戶支援功能，具備知識庫搜尋、訂單狀態查詢和支援工單建立的工具。',
          model: 'gemini-2.0-flash-exp',
          tools: [
            {
              name: 'search_knowledge_base',
              description: '搜尋知識庫以尋找相關資訊',
            },
            {
              name: 'lookup_order_status',
              description: '查詢客戶訂單的狀態',
            },
            {
              name: 'create_support_ticket',
              description: '為複雜問題建立支援工單',
            },
            {
              name: 'get_product_details',
              description: '從資料庫獲取產品詳情',
            },
          ],
        },
        {
          name: 'lead_qualifier',
          path: 'workspace/python/agents/enterprise-agent',
          type: 'Agent',
          description: '企業銷售潛在客戶資格鑑定代理',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'check_company_size',
              description: '檢查公司規模',
            },
            {
              name: 'score_lead',
              description: '根據標準對銷售潛在客戶進行評分',
            },
            {
              name: 'get_competitive_intel',
              description: '收集競爭情報',
            },
          ],
        },
        {
          name: 'EssayRefinementSystem',
          path: 'workspace/python/agents/essay-refiner',
          type: 'SequentialAgent',
          description: '完整的論文寫作與精煉系統',
          sub_agents: [
            {
              name: 'InitialWriter',
            },
            {
              name: 'RefinementLoop',
              type: 'LoopAgent',
              sub_agents: [
                {
                  name: 'Critic',
                },
                {
                  name: 'Refiner',
                  tools: ['exit_loop'],
                },
              ],
            },
          ],
        },
        {
          name: 'advanced_grounding_agent',
          path: 'workspace/python/agents/grounding-agent',
          type: 'Agent',
          description: '具有搜尋、分析和條件地圖工具的高級 grounding 代理',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'google_search',
              description: '執行 Google 搜尋',
            },
            {
              name: 'google_maps_grounding (Conditional)',
              description: '使用 Google 地圖數據提供 grounding',
            },
            {
              name: 'analyze_search_results',
              description: '分析搜尋結果',
            },
            {
              name: 'save_research_findings',
              description: '保存研究發現',
            },
          ],
        },
        {
          name: 'mcp_file_assistant',
          path: 'workspace/python/agents/mcp-agent',
          type: 'Agent',
          description: '透過 MCP 存取檔案系統的 AI 助理',
          model: 'gemini-2.0-flash-exp',
          tools: [
            {
              name: 'McpToolset (filesystem)',
              description: '透過 MCP 提供對檔案系統操作的存取',
            },
          ],
        },
        {
          name: 'model_selector_agent',
          path: 'workspace/python/agents/model-selector',
          type: 'Agent',
          description: '用於選擇和比較 AI 模型的專家代理',
          model: 'gemini-2.5-flash',
          tools: [
            {
              name: 'recommend_model_for_use_case',
              description: '為特定使用案例推薦 AI 模型',
            },
            {
              name: 'get_model_info',
              description: '檢索特定 AI 模型的資訊',
            },
          ],
        },
        {
          name: 'multi_llm_agent',
          path: 'workspace/python/agents/multi-llm-agent',
          type: 'Agent',
          description: '透過 LiteLLM 支援 OpenAI、Claude 等的多 LLM 代理',
          model: 'openai/gpt-4o-mini',
          tools: [
            {
              name: 'calculate_square',
              description: '計算一個數字的平方',
            },
            {
              name: 'get_weather',
              description: '獲取特定城市的天氣',
            },
            {
              name: 'analyze_sentiment',
              description: '分析文本的情感',
            },
          ],
        },
        {
          name: 'customer_service',
          path: 'workspace/python/agents/observability-agent',
          type: 'Agent',
          description: '具有事件追蹤功能的客戶服務代理',
          model: 'gemini-2.0-flash-exp',
          tools: [
            {
              name: 'check_order_status',
              description: '檢查特定訂單的狀態',
            },
            {
              name: 'process_refund',
              description: '處理訂單的退款',
            },
            {
              name: 'check_inventory',
              description: '檢查產品的庫存可用性',
            },
          ],
        },
        {
          name: 'observability_plugins_agent',
          path: 'workspace/python/agents/observability-plugins-agent',
          type: 'Agent',
          description: '具有全面可觀測性外掛的生產助理',
          model: 'gemini-2.5-flash',
          plugins: [
            'MetricsCollectorPlugin',
            'AlertingPlugin',
            'PerformanceProfilerPlugin',
          ],
        },
        {
          name: 'personal_tutor',
          path: 'workspace/python/agents/personal-tutor',
          type: 'Agent',
          description: '追蹤用戶進度和偏好的個人家教',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'set_user_preferences',
              description: '設定用戶的學習偏好',
            },
            {
              name: 'record_topic_completion',
              description: '記錄學習主題的完成情況',
            },
            {
              name: 'get_user_progress',
              description: '檢索用戶的當前進度',
            },
            {
              name: 'start_learning_session',
              description: '開始新的學習會話',
            },
            {
              name: 'calculate_quiz_grade',
              description: '計算測驗的成績',
            },
            {
              name: 'search_past_lessons',
              description: '搜尋過去的課程',
            },
          ],
        },
        {
          name: 'production_deployment_agent',
          path: 'workspace/python/agents/production-agent',
          type: 'Agent',
          description: '關於生產部署策略的專家',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'check_deployment_status',
              description: '檢查部署狀態',
            },
            {
              name: 'get_deployment_options',
              description: '獲取可用的部署選項',
            },
            {
              name: 'get_best_practices',
              description: '檢索部署最佳實踐',
            },
          ],
        },
        {
          name: 'software_bug_assistant',
          path: 'workspace/python/agents/software-bug-assistant',
          type: 'Agent',
          description: '軟體錯誤助理',
          model: 'gemini-2.5-flash',
          tools: [
            {
              name: 'get_current_date',
              description: '獲取當前日期',
            },
            {
              name: 'search_tool (AgentTool)',
              description: '代理的搜尋工具包裝器',
            },
            {
              name: 'langchain_tool (StackExchange)',
              description: '透過 LangChain 的 StackExchange 搜尋工具',
            },
            {
              name: 'toolbox_tools (Google Cloud Toolbox)',
              description: 'Google Cloud Toolbox 工具集',
            },
            {
              name: 'mcp_tools (GitHub MCP)',
              description: '用於程式碼互動的 GitHub MCP 工具',
            },
          ],
        },
        {
          name: 'plan_react_strategic_solver',
          path: 'workspace/python/agents/strategic-solver',
          type: 'Agent',
          description: '使用 PlanReActPlanner 的策略性業務顧問',
          model: 'gemini-2.0-flash',
          planner: 'PlanReActPlanner',
          tools: [
            {
              name: 'analyze_market',
              description: '分析市場趨勢和數據',
            },
            {
              name: 'calculate_roi',
              description: '計算投資回報率 (ROI)',
            },
            {
              name: 'assess_risk',
              description: '評估潛在的業務風險',
            },
            {
              name: 'save_strategy_report',
              description: '保存生成的策略報告',
            },
          ],
        },
        {
          name: 'streaming_assistant',
          path: 'workspace/python/agents/streaming-agent',
          type: 'Agent',
          description: '提供即時串流回應的樂於助人的助理',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'format_streaming_info',
              description: '格式化用於串流回應的資訊',
            },
            {
              name: 'analyze_streaming_performance',
              description: '分析串流性能指標',
            },
          ],
        },
        {
          name: 'support_agent',
          path: 'workspace/python/agents/support-agent',
          type: 'Agent',
          description: '具有知識庫搜尋和工單創建功能的客戶支援代理',
          model: 'gemini-2.0-flash-exp',
          tools: [
            {
              name: 'search_knowledge_base',
              description: '在知識庫中搜尋解決方案',
            },
            {
              name: 'create_ticket',
              description: '創建新的支援工單',
            },
            {
              name: 'check_ticket_status',
              description: '檢查現有工單的狀態',
            },
          ],
        },
        {
          name: 'third_party_agent',
          path: 'workspace/python/agents/third-party-agent',
          type: 'Agent',
          description: '整合第三方工具 (LangChain, CrewAI) 的代理',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'create_wikipedia_tool',
              description: '創建一個用於 Wikipedia 搜尋的工具',
            },
            {
              name: 'create_web_search_tool',
              description: '創建一個用於一般網路搜尋的工具',
            },
            {
              name: 'create_directory_read_tool',
              description: '創建一個用於讀取目錄內容的工具',
            },
            {
              name: 'create_file_read_tool',
              description: '創建一個用於讀取檔案內容的工具',
            },
          ],
        },
        {
          name: 'a2a_orchestrator',
          path: 'workspace/python/agents/a2a-orchestrator',
          type: 'Agent',
          description: '使用 ADK A2A 協調遠端代理的協調器代理',
          model: 'gemini-2.0-flash',
          sub_agents: [
            {
              name: 'research_specialist',
              type: 'RemoteA2aAgent',
            },
            {
              name: 'data_analyst',
              type: 'RemoteA2aAgent',
            },
            {
              name: 'content_writer',
              type: 'RemoteA2aAgent',
            },
          ],
          tools: [
            {
              name: 'check_agent_availability',
              description: '檢查特定代理是否可用',
            },
            {
              name: 'log_coordination_step',
              description: '記錄協調過程中的一個步驟',
            },
          ],
        },
        {
          name: 'artifact_agent',
          path: 'workspace/python/agents/artifact-agent',
          type: 'Agent',
          description: '具有 artifact 儲存和版本控制功能的文件處理代理',
          model: 'gemini-1.5-flash',
          tools: [
            {
              name: 'extract_text_tool',
              description: '從文件中提取文本',
            },
            {
              name: 'summarize_document_tool',
              description: '總結文件的內容',
            },
            {
              name: 'translate_document_tool',
              description: '將文件翻譯成另一種語言',
            },
            {
              name: 'create_final_report_tool',
              description: '從處理過的數據創建最終報告',
            },
            {
              name: 'list_artifacts_tool',
              description: '列出所有可用的 artifact',
            },
            {
              name: 'load_artifact_tool',
              description: '載入特定的 artifact',
            },
            {
              name: 'load_artifacts_tool',
              description: '載入多個 artifact',
            },
          ],
        },
        {
          name: 'best_practices_agent',
          path: 'workspace/python/agents/best-practices-agent',
          type: 'Agent',
          description: '展示最佳實踐的生產就緒代理',
          model: 'gemini-2.5-flash',
          tools: [
            {
              name: 'validate_input_tool',
              description: '根據 schema 驗證輸入數據',
            },
            {
              name: 'retry_with_backoff_tool',
              description: '使用指數退避重試操作',
            },
            {
              name: 'circuit_breaker_call_tool',
              description: '執行包裝在斷路器中的呼叫',
            },
            {
              name: 'cache_operation_tool',
              description: '執行快取操作',
            },
            {
              name: 'batch_process_tool',
              description: '批次處理項目',
            },
            {
              name: 'health_check_tool',
              description: '檢查系統的健康狀況',
            },
            {
              name: 'get_metrics_tool',
              description: '檢索系統指標',
            },
          ],
        },
        {
          name: 'TravelPlanningSystem',
          path: 'workspace/python/agents/travel-planner',
          type: 'SequentialAgent',
          description: '具有平行搜尋功能的完整旅行規劃系統',
          sub_agents: [
            {
              name: 'ParallelSearch',
              type: 'ParallelAgent',
              sub_agents: [
                {
                  name: 'flight_finder',
                },
                {
                  name: 'hotel_finder',
                },
                {
                  name: 'activity_finder',
                },
              ],
            },
            {
              name: 'itinerary_builder',
            },
          ],
        },
        {
          name: 'vision_catalog_coordinator',
          path: 'workspace/python/agents/vision-catalog-agent',
          type: 'Agent',
          description: '多模態視覺產品目錄協調器',
          model: 'gemini-2.0-flash-exp',
          tools: [
            {
              name: 'list_sample_images',
              description: '列出可供處理的範例圖片',
            },
            {
              name: 'generate_product_mockup',
              description: '生成產品的視覺模型',
            },
            {
              name: 'analyze_uploaded_image',
              description: '分析用戶上傳的圖片',
            },
            {
              name: 'analyze_product_image',
              description: '分析產品圖片以獲取詳細資訊',
            },
            {
              name: 'compare_product_images',
              description: '比較兩張產品圖片',
            },
          ],
        },
        {
          name: 'voice_assistant',
          path: 'workspace/python/agents/voice-assistant',
          type: 'Agent',
          description: '支援 Live API 的即時語音助理',
          model: 'gemini-2.0-flash-live-001',
          capabilities: ['音訊錄製/播放', 'Live API 串流'],
        },
        {
          name: 'youtube_shorts_agent',
          path: 'workspace/python/agents/youtube-shorts-assistant',
          type: 'LlmAgent',
          description: '用於創建 YouTube Short 影片的代理',
          model: 'gemini-2.0-flash-001',
          tools: [
            {
              name: 'scriptwriter_agent (AgentTool)',
              description: '負責撰寫影片腳本的代理',
            },
            {
              name: 'visualizer_agent (AgentTool)',
              description: '負責創建視覺概念的代理',
            },
            {
              name: 'formatter_agent (AgentTool)',
              description: '負責格式化最終內容的代理',
            },
          ],
        },
        {
          name: 'gepa_optimization_agent',
          path: 'workspace/python/agents/gepa-optimization-agent',
          type: 'Agent',
          description:
            '一個客服代理，展示了如何使用 GEPA（遺rac遺傳演算法-帕雷托提示最佳化）來自動優化 LLM 代理的提示詞。',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'verify_customer_identity',
              description: '檢查訂單 ID + 電子郵件',
            },
            {
              name: 'check_return_policy',
              description: '驗證 30 天退貨期限',
            },
            {
              name: 'process_refund',
              description: '驗證後執行退款',
            },
          ],
        },
        {
          name: 'ui_integration_agent',
          path: 'workspace/python/agents/ui-integration',
          type: 'Agent',
          description:
            '一個最小化的實作，示範如何使用 AG-UI 協定 (AG-UI Protocol) 將 ADK 代理與 React UI 整合。',
          model: 'gemini-2.0-flash-exp',
          tools: [],
        },
        {
          name: 'data_analyst',
          path: 'workspace/python/agents/data-analysis-dashboard/agent',
          type: 'Agent',
          description:
            '結合 pandas 與 Chart.js 視覺化的 CSV 數據分析 ADK agent',
          model: 'gemini-2.0-flash-exp',
          tools: [
            {
              name: 'load_csv_data',
              description: '將 CSV 數據載入記憶體以進行分析',
            },
            {
              name: 'analyze_data',
              description: '對載入的數據集執行統計分析',
            },
            {
              name: 'create_chart',
              description: '生成視覺化圖表數據',
            },
          ],
        },
        {
          name: 'data_analysis_agent',
          path: 'workspace/python/agents/data-analysis-agent',
          type: 'Agent',
          description: '整合 Streamlit 與 ADK 的資料分析助理',
          model: 'gemini-2.0-flash',
          tools: [
            {
              name: 'analyze_column',
              description: '統計分析',
            },
            {
              name: 'calculate_correlation',
              description: '尋找關聯性',
            },
            {
              name: 'filter_data',
              description: '子集探索',
            },
            {
              name: 'get_dataset_summary',
              description: '概覽資訊',
            },
          ],
        },
        {
          name: 'support_bot',
          path: 'workspace/python/agents/support-bot',
          type: 'Agent',
          description: '協助處理公司政策與問題的團隊支援助理',
          model: 'gemini-2.5-flash',
          tools: [
            {
              name: 'search_knowledge_base',
              description: '搜尋公司知識庫以獲取資訊',
            },
            {
              name: 'create_support_ticket',
              description: '為複雜問題建立支援工單',
            },
          ],
        },
        {
          name: 'pubsub_processor',
          path: 'workspace/python/agents/pubsub-agent',
          type: 'Agent',
          description:
            '整合 Pub/Sub 與 ADK 建構的事件驅動文件處理協調者，負責將文件路由到專門的分析器。',
          model: 'gemini-2.5-flash',
          tools: [
            {
              name: 'financial_analyzer',
              description: '分析財務報告、收益、預算',
            },
            {
              name: 'technical_analyzer',
              description: '分析技術文件、架構、規格書',
            },
            {
              name: 'sales_analyzer',
              description: '分析銷售管道、交易、預測',
            },
            {
              name: 'marketing_analyzer',
              description: '分析行銷活動、參與度指標',
            },
          ],
        },
        {
          name: 'commerce_agent_e2e',
          path: 'workspace/python/agents/commerce-agent-e2e',
          type: 'Agent',
          description:
            '一位個人運動購物禮賓，使用 Google Search 接地與儲存的使用者偏好來提供專家級產品推薦。',
          model: 'gemini-2.5-flash',
          tools: [
            {
              name: 'search_products',
              description: '包裝 Google Search 的 AgentTool',
            },
            {
              name: 'save_preferences',
              description: '儲存使用者偏好',
            },
            {
              name: 'get_preferences',
              description: '取得使用者偏好',
            },
          ],
        },
        {
          name: 'policy_navigator',
          path: 'workspace/python/agents/policy-navigator',
          type: 'Agent',
          description:
            '企業合規與政策導航器，利用 File Search 構建 RAG，實作文件管理、搜尋專家、合規顧問與報告產生器等多代理人協作。',
          model: 'gemini-2.0-flash',
          sub_agents: [
            {
              name: 'document_manager',
              description: '管理政策文件上傳、組織與 metadata 設定',
            },
            {
              name: 'search_specialist',
              description: '搜尋公司政策並檢索相關資訊',
            },
            {
              name: 'compliance_advisor',
              description: '評估合規風險並提供政策指導',
            },
            {
              name: 'report_generator',
              description: '產生政策摘要、報告與稽核追蹤',
            },
          ],
          tools: [
            {
              name: 'upload_policy_documents',
              description: '將政策文件上傳到 File Search stores',
            },
            {
              name: 'search_policies',
              description: '對政策文件執行語意搜尋',
            },
            {
              name: 'filter_policies_by_metadata',
              description: '依部門、類型與日期過濾政策',
            },
            {
              name: 'compare_policies',
              description: '跨部門比較政策',
            },
            {
              name: 'check_compliance_risk',
              description: '評估與政策相關的合規風險',
            },
            {
              name: 'extract_policy_requirements',
              description: '從政策中擷取特定需求',
            },
            {
              name: 'generate_policy_summary',
              description: '建立簡潔的政策摘要',
            },
            {
              name: 'create_audit_trail',
              description: '建立稽核追蹤項目',
            },
          ],
        },
        {
          name: 'mcp_a2a_master_agent',
          path: 'workspace/python/agents/mcp-a2a-master/',
          type: 'Agent',
          description:
            '整合 cmd 與 MCP 的 A2A 主協調者代理，展示跨代理通訊與協作。',
          model: 'gemini-2.5-flash',
          tools: [
            {
              name: '_list_agents',
              description:
                'A2A 工具：回傳已註冊的 A2A 子代理的代理卡片物件字典列表。',
            },
            {
              name: '_delgate_task',
              description: '將任務委派給指定的代理。',
            },
            {
              name: 'add_numbers',
              description: '將兩個數字相加並回傳結果。',
            },
            {
              name: 'terminal_server',
              description: '在終端機中執行指令並回傳輸出。',
            },
          ],
        },
        {
          name: 'math_agent_otel',
          path: 'workspace/python/agents/math-agent-otel',
          type: 'Agent',
          description:
            '具有 OpenTelemetry 儀表化的 ADK 數學代理，展示使用 Jaeger 後端的分散式追蹤與結構化日誌。',
          model: 'gemini-2.5-flash',
          tools: [
            {
              name: 'add_numbers',
              description: '將兩個數字相加',
            },
            {
              name: 'subtract_numbers',
              description: '從 a 減去 b',
            },
            {
              name: 'multiply_numbers',
              description: '將兩個數字相乘',
            },
            {
              name: 'divide_numbers',
              description: '將 a 除以 b',
            },
          ],
        },
        {
          name: 'pack_adk_a2a_agent',
          path: 'workspace/python/agents/pack-adk-a2a-agent',
          type: 'Agent',
          description:
            '一個可以提供有關天氣和時間資訊的代理程式，並支援 A2A 通訊。',
          model: 'gemini-3-pro-preview',
          tools: [
            {
              name: 'get_weather',
              description: '模擬網路搜尋。使用它來獲取天氣資訊。',
            },
            {
              name: 'get_current_time',
              description: '模擬獲取城市的當前時間。',
            },
          ],
        },
        {
          name: 'interactions_api_basic',
          path: 'workspace/python/agents/interactions-api-basic',
          type: 'Agent',
          description:
            '展示 Google Interactions API 的基礎功能，包含有狀態對話、Gemini 模型互動、串流回應與 Function Calling。',
          model: 'gemini-2.5-flash',
          tools: [
            {
              name: 'google_search',
              description: '內建 Google 搜尋工具',
            },
            {
              name: 'code_execution',
              description: '內建 Python 程式碼執行工具',
            },
            {
              name: 'get_weather',
              description: '演示用的天氣查詢工具 (Function Calling)',
            },
          ],
        },
      ];
      // DOM 元素
      const agentsGrid = document.getElementById('agents-grid');
      const searchInput = document.getElementById('search-input');
      const clearBtn = document.getElementById('clear-btn');
      const totalCount = document.getElementById('total-count');
      const agentTypesCount = document.getElementById('agent-types-count');
      const modal = document.getElementById('detail-modal');
      const modalTitle = document.getElementById('modal-title');
      const modalType = document.getElementById('modal-type');
      const modalPath = document.getElementById('modal-path');
      const modalBody = document.getElementById('modal-body');
      const closeBtn = document.getElementById('close-btn');

      let filteredData = [...agentsData];

      // 更新統計資訊
      function updateStats() {
        totalCount.textContent = filteredData.length;
        const types = new Set(filteredData.map((a) => a.type));
        agentTypesCount.textContent = `${types.size} 種類型`;
      }

      // 渲染代理卡片
      function renderAgents() {
        if (filteredData.length === 0) {
          agentsGrid.innerHTML = `
            <div class="empty-state">
              <svg fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path>
              </svg>
              <h3>找不到相符的代理</h3>
              <p>請嘗試其他搜尋關鍵字</p>
            </div>
          `;
          return;
        }

        agentsGrid.innerHTML = filteredData
          .map(
            (agent) => `
          <div class="agent-card" onclick="showDetail('${agent.name}')">
            <div class="agent-header">
              <div class="agent-icon">
                <img src="assets/adk.png" alt="Agent Icon" />
              </div>
              <div class="agent-title-group">
                <div class="agent-title">${agent.name}</div>
                <a href="https://github.com/lastingyeh/google-adk-study/tree/master/${
                  agent.path
                }"
                   class="agent-path"
                   target="_blank"
                   rel="noopener noreferrer"
                   onclick="event.stopPropagation()"
                   title="${agent.path}">
                  <svg fill="currentColor" viewBox="0 0 16 16">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                  </svg>
                  <span>${agent.path.split('/').pop()}</span>
                </a>
              </div>
            </div>

            <div class="agent-description">${agent.description}</div>

            <div class="agent-labels">
              <span class="label-tag type">${agent.type}</span>
              ${
                agent.model
                  ? `<span class="label-tag model">${agent.model}</span>`
                  : ''
              }
            </div>

            <div class="agent-meta">
              ${
                agent.tools
                  ? `
                <div class="meta-item">
                  <svg fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>
                  </svg>
                  <span>${agent.tools.length} 工具</span>
                </div>
              `
                  : ''
              }
              ${
                agent.sub_agents
                  ? `
                <div class="meta-item">
                  <svg fill="currentColor" viewBox="0 0 20 20">
                    <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"></path>
                  </svg>
                  <span>${agent.sub_agents.length} 子代理</span>
                </div>
              `
                  : ''
              }
            </div>
          </div>
        `
          )
          .join('');
      }

      // 搜尋功能
      function performSearch(query) {
        const searchTerm = query.toLowerCase().trim();

        if (searchTerm === '') {
          filteredData = [...agentsData];
        } else {
          filteredData = agentsData.filter((agent) => {
            const searchableFields = [
              agent.name,
              agent.description,
              agent.type,
              agent.model,
              ...(agent.tools || []).map((t) => t.name + ' ' + t.description),
              ...(agent.sub_agents || []).map((s) => s.name),
            ]
              .filter(Boolean)
              .join(' ')
              .toLowerCase();

            return searchableFields.includes(searchTerm);
          });
        }

        updateStats();
        renderAgents();
      }

      // 顯示詳細資訊
      function showDetail(agentName) {
        const agent = agentsData.find((a) => a.name === agentName);
        if (!agent) return;

        modalType.textContent = agent.type;
        modalTitle.textContent = agent.name;
        modalPath.innerHTML = `<a href="https://github.com/lastingyeh/google-adk-study/tree/master/${
          agent.path
        }"
          class="modal-path"
          target="_blank"
          rel="noopener noreferrer"
          title="${agent.path}">
          <svg fill="currentColor" viewBox="0 0 16 16">
            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
          </svg>
          ${agent.path.split('/').pop()}
        </a>`;

        let bodyHTML = `
          <div class="detail-section">
            <h3>
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              功能描述
            </h3>
            <div class="description-box">${agent.description}</div>
          </div>
        `;

        // 標籤區
        const labels = [];
        if (agent.type) labels.push(agent.type);
        if (agent.model) labels.push(`Model: ${agent.model}`);

        if (labels.length > 0) {
          bodyHTML += `
            <div class="detail-section">
              <h3>
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                </svg>
                標籤
              </h3>
              <div class="modal-labels">
                ${labels
                  .map((l) => `<span class="modal-label-tag">${l}</span>`)
                  .join('')}
              </div>
            </div>
          `;
        }

        // 工具列表
        if (agent.tools && agent.tools.length > 0) {
          bodyHTML += `
            <div class="detail-section">
              <h3>
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                可用工具 (${agent.tools.length})
              </h3>
              <div class="detail-list">
                ${agent.tools
                  .map(
                    (tool) => `
                  <div class="detail-item">
                    <strong>${tool.name}</strong>
                    <p>${tool.description}</p>
                  </div>
                `
                  )
                  .join('')}
              </div>
            </div>
          `;
        }

        // 子代理列表
        if (agent.sub_agents && agent.sub_agents.length > 0) {
          bodyHTML += `
            <div class="detail-section">
              <h3>
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                </svg>
                子代理 (${agent.sub_agents.length})
              </h3>
              <div class="detail-list">
                ${agent.sub_agents
                  .map(
                    (sub) => `
                  <div class="detail-item">
                    <strong>${sub.name}</strong>
                    ${sub.description ? `<p>${sub.description}</p>` : ''}
                  </div>
                `
                  )
                  .join('')}
              </div>
            </div>
          `;
        }

        // 其他功能
        const extras = [];
        if (agent.capabilities) {
          extras.push(`Capabilities: ${agent.capabilities.join(', ')}`);
        }
        if (agent.toolsets) {
          extras.push(
            `Toolsets: ${agent.toolsets
              .map((t) => `${t.name} (${t.type})`)
              .join(', ')}`
          );
        }
        if (agent.callbacks) {
          extras.push(`Callbacks: ${agent.callbacks.length} 個回調`);
        }

        if (extras.length > 0) {
          bodyHTML += `
            <div class="detail-section">
              <h3>
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                </svg>
                其他功能
              </h3>
              <div class="detail-list">
                ${extras
                  .map((e) => `<div class="detail-item">${e}</div>`)
                  .join('')}
              </div>
            </div>
          `;
        }

        modalBody.innerHTML = bodyHTML;
        modal.classList.add('show');
      }

      // 關閉 Modal
      function closeModal() {
        modal.classList.remove('show');
      }

      // 事件監聽
      searchInput.addEventListener('input', (e) => {
        performSearch(e.target.value);
      });

      clearBtn.addEventListener('click', () => {
        searchInput.value = '';
        performSearch('');
      });

      modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
      });

      closeBtn.addEventListener('click', closeModal);

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('show')) {
          closeModal();
        }
      });

      // 初始化
      updateStats();
      renderAgents();
    </script>
  </body>
</html>
